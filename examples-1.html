<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>36 Examples | Advanced Environmental Data Management</title>
  <meta name="description" content="36 Examples | Advanced Environmental Data Management" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="36 Examples | Advanced Environmental Data Management" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="36 Examples | Advanced Environmental Data Management" />
  
  
  

<meta name="author" content="Whitney Adam" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-5.html"/>
<link rel="next" href="introduction-6.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html"><i class="fa fa-check"></i><b>2</b> Importing Data into R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#typing-vectors-and-matrices"><i class="fa fa-check"></i><b>2.1</b> Typing Vectors and Matrices</a></li>
<li class="chapter" data-level="2.2" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#reading-data-frame"><i class="fa fa-check"></i><b>2.2</b> Reading Data Frame</a></li>
<li class="chapter" data-level="2.3" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#fixed-with-input-files"><i class="fa fa-check"></i><b>2.3</b> Fixed-with Input Files</a></li>
<li class="chapter" data-level="2.4" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#generating-data"><i class="fa fa-check"></i><b>2.4</b> Generating Data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#sequences"><i class="fa fa-check"></i><b>2.4.1</b> Sequences</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#random-number-generators"><i class="fa fa-check"></i><b>2.5</b> Random Number Generators</a></li>
<li class="chapter" data-level="2.6" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#random-permutation"><i class="fa fa-check"></i><b>2.6</b> Random Permutation</a></li>
<li class="chapter" data-level="2.7" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#spreadsheet"><i class="fa fa-check"></i><b>2.7</b> Spreadsheet</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="saving-r-data.html"><a href="saving-r-data.html"><i class="fa fa-check"></i><b>3</b> Saving R Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="saving-r-data.html"><a href="saving-r-data.html#writing-r-objects-to-files-in-ascii-format"><i class="fa fa-check"></i><b>3.1</b> Writing R Objects to Files in ASCII Format</a></li>
<li class="chapter" data-level="3.2" data-path="saving-r-data.html"><a href="saving-r-data.html#reading-data-from-other-programs"><i class="fa fa-check"></i><b>3.2</b> Reading Data from Other Programs</a></li>
<li class="chapter" data-level="3.3" data-path="saving-r-data.html"><a href="saving-r-data.html#functions-in-foreign-package"><i class="fa fa-check"></i><b>3.3</b> Functions in <code>foreign</code> package</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="date-objects.html"><a href="date-objects.html"><i class="fa fa-check"></i><b>4</b> Date Objects</a>
<ul>
<li class="chapter" data-level="4.1" data-path="date-objects.html"><a href="date-objects.html#date-formats-in-r-date-time-classes"><i class="fa fa-check"></i><b>4.1</b> Date formats in R date-time classes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>5</b> Summary Statistics</a></li>
<li class="chapter" data-level="6" data-path="anatomy-of-a-plot.html"><a href="anatomy-of-a-plot.html"><i class="fa fa-check"></i><b>6</b> Anatomy of a Plot</a></li>
<li class="chapter" data-level="7" data-path="customizing-a-plot.html"><a href="customizing-a-plot.html"><i class="fa fa-check"></i><b>7</b> Customizing a Plot</a></li>
<li class="chapter" data-level="8" data-path="graphical-functions.html"><a href="graphical-functions.html"><i class="fa fa-check"></i><b>8</b> Graphical Functions</a></li>
<li class="chapter" data-level="9" data-path="example-lake-erie-harmful-algal-bloom-monitoring.html"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html"><i class="fa fa-check"></i><b>9</b> Example: Lake Erie Harmful Algal Bloom Monitoring</a>
<ul>
<li class="chapter" data-level="9.1" data-path="example-lake-erie-harmful-algal-bloom-monitoring.html"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#data"><i class="fa fa-check"></i><b>9.1</b> Data</a></li>
<li class="chapter" data-level="9.2" data-path="example-lake-erie-harmful-algal-bloom-monitoring.html"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#mc-distribution"><i class="fa fa-check"></i><b>9.2</b> MC Distribution</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="example-lake-erie-harmful-algal-bloom-monitoring.html"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#histogram-and-boxplot"><i class="fa fa-check"></i><b>9.2.1</b> Histogram and boxplot</a></li>
<li class="chapter" data-level="9.2.2" data-path="example-lake-erie-harmful-algal-bloom-monitoring.html"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#comparing-to-the-normal-distribution"><i class="fa fa-check"></i><b>9.2.2</b> Comparing to the normal distribution</a></li>
<li class="chapter" data-level="9.2.3" data-path="example-lake-erie-harmful-algal-bloom-monitoring.html"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#comparing-two-distributions"><i class="fa fa-check"></i><b>9.2.3</b> Comparing Two Distributions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>10</b> Introduction</a></li>
<li class="chapter" data-level="11" data-path="data-1.html"><a href="data-1.html"><i class="fa fa-check"></i><b>11</b> Data</a></li>
<li class="chapter" data-level="12" data-path="using-package-reshape.html"><a href="using-package-reshape.html"><i class="fa fa-check"></i><b>12</b> Using package <code>reshape</code></a></li>
<li class="chapter" data-level="13" data-path="subscripting.html"><a href="subscripting.html"><i class="fa fa-check"></i><b>13</b> Subscripting</a>
<ul>
<li class="chapter" data-level="13.1" data-path="subscripting.html"><a href="subscripting.html#numerical-subscripts"><i class="fa fa-check"></i><b>13.1</b> Numerical Subscripts</a></li>
<li class="chapter" data-level="13.2" data-path="subscripting.html"><a href="subscripting.html#character-subscripts"><i class="fa fa-check"></i><b>13.2</b> Character Subscripts</a></li>
<li class="chapter" data-level="13.3" data-path="subscripting.html"><a href="subscripting.html#logical-subscripts"><i class="fa fa-check"></i><b>13.3</b> Logical Subscripts</a></li>
<li class="chapter" data-level="13.4" data-path="subscripting.html"><a href="subscripting.html#subscripting-matrices"><i class="fa fa-check"></i><b>13.4</b> Subscripting Matrices</a></li>
<li class="chapter" data-level="13.5" data-path="subscripting.html"><a href="subscripting.html#dropfalse"><i class="fa fa-check"></i><b>13.5</b> <code>drop=FALSE</code></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="two-useful-functions-for-matrix.html"><a href="two-useful-functions-for-matrix.html"><i class="fa fa-check"></i><b>14</b> Two Useful Functions for Matrix</a></li>
<li class="chapter" data-level="15" data-path="list.html"><a href="list.html"><i class="fa fa-check"></i><b>15</b> List</a></li>
<li class="chapter" data-level="16" data-path="aggregation.html"><a href="aggregation.html"><i class="fa fa-check"></i><b>16</b> Aggregation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="aggregation.html"><a href="aggregation.html#tabulation"><i class="fa fa-check"></i><b>16.1</b> Tabulation</a></li>
<li class="chapter" data-level="16.2" data-path="aggregation.html"><a href="aggregation.html#general-considerations-of-aggregation"><i class="fa fa-check"></i><b>16.2</b> General Considerations of Aggregation</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="aggregation.html"><a href="aggregation.html#sapply"><i class="fa fa-check"></i><b>16.2.1</b> <code>sapply</code></a></li>
<li class="chapter" data-level="16.2.2" data-path="aggregation.html"><a href="aggregation.html#apply"><i class="fa fa-check"></i><b>16.2.2</b> <code>apply</code></a></li>
<li class="chapter" data-level="16.2.3" data-path="aggregation.html"><a href="aggregation.html#mapping-a-function-based-on-groups"><i class="fa fa-check"></i><b>16.2.3</b> Mapping a Function Based on Groups</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="transform.html"><a href="transform.html"><i class="fa fa-check"></i><b>17</b> Data transformation</a>
<ul>
<li class="chapter" data-level="17.1" data-path="transform.html"><a href="transform.html#introduction-2"><i class="fa fa-check"></i><b>17.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="transform.html"><a href="transform.html#prerequisites"><i class="fa fa-check"></i><b>17.1.1</b> Prerequisites</a></li>
<li class="chapter" data-level="17.1.2" data-path="transform.html"><a href="transform.html#nycflights13"><i class="fa fa-check"></i><b>17.1.2</b> nycflights13</a></li>
<li class="chapter" data-level="17.1.3" data-path="transform.html"><a href="transform.html#dplyr-basics"><i class="fa fa-check"></i><b>17.1.3</b> dplyr basics</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="transform.html"><a href="transform.html#filter-rows-with-filter"><i class="fa fa-check"></i><b>17.2</b> Filter rows with <code>filter()</code></a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="transform.html"><a href="transform.html#comparisons"><i class="fa fa-check"></i><b>17.2.1</b> Comparisons</a></li>
<li class="chapter" data-level="17.2.2" data-path="transform.html"><a href="transform.html#logical-operators"><i class="fa fa-check"></i><b>17.2.2</b> Logical operators</a></li>
<li class="chapter" data-level="17.2.3" data-path="transform.html"><a href="transform.html#missing-values"><i class="fa fa-check"></i><b>17.2.3</b> Missing values</a></li>
<li class="chapter" data-level="17.2.4" data-path="transform.html"><a href="transform.html#exercises"><i class="fa fa-check"></i><b>17.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="transform.html"><a href="transform.html#arrange-rows-with-arrange"><i class="fa fa-check"></i><b>17.3</b> Arrange rows with <code>arrange()</code></a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="transform.html"><a href="transform.html#exercises-1"><i class="fa fa-check"></i><b>17.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="transform.html"><a href="transform.html#select"><i class="fa fa-check"></i><b>17.4</b> Select columns with <code>select()</code></a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="transform.html"><a href="transform.html#exercises-2"><i class="fa fa-check"></i><b>17.4.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="transform.html"><a href="transform.html#add-new-variables-with-mutate"><i class="fa fa-check"></i><b>17.5</b> Add new variables with <code>mutate()</code></a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="transform.html"><a href="transform.html#mutate-funs"><i class="fa fa-check"></i><b>17.5.1</b> Useful creation functions</a></li>
<li class="chapter" data-level="17.5.2" data-path="transform.html"><a href="transform.html#exercises-3"><i class="fa fa-check"></i><b>17.5.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="transform.html"><a href="transform.html#grouped-summaries-with-summarise"><i class="fa fa-check"></i><b>17.6</b> Grouped summaries with <code>summarise()</code></a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="transform.html"><a href="transform.html#combining-multiple-operations-with-the-pipe"><i class="fa fa-check"></i><b>17.6.1</b> Combining multiple operations with the pipe</a></li>
<li class="chapter" data-level="17.6.2" data-path="transform.html"><a href="transform.html#missing-values-1"><i class="fa fa-check"></i><b>17.6.2</b> Missing values</a></li>
<li class="chapter" data-level="17.6.3" data-path="transform.html"><a href="transform.html#counts"><i class="fa fa-check"></i><b>17.6.3</b> Counts</a></li>
<li class="chapter" data-level="17.6.4" data-path="transform.html"><a href="transform.html#summarise-funs"><i class="fa fa-check"></i><b>17.6.4</b> Useful summary functions</a></li>
<li class="chapter" data-level="17.6.5" data-path="transform.html"><a href="transform.html#grouping-by-multiple-variables"><i class="fa fa-check"></i><b>17.6.5</b> Grouping by multiple variables</a></li>
<li class="chapter" data-level="17.6.6" data-path="transform.html"><a href="transform.html#ungrouping"><i class="fa fa-check"></i><b>17.6.6</b> Ungrouping</a></li>
<li class="chapter" data-level="17.6.7" data-path="transform.html"><a href="transform.html#exercises-4"><i class="fa fa-check"></i><b>17.6.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="transform.html"><a href="transform.html#grouped-mutates-and-filters"><i class="fa fa-check"></i><b>17.7</b> Grouped mutates (and filters)</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="transform.html"><a href="transform.html#exercises-5"><i class="fa fa-check"></i><b>17.7.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="package-reshape.html"><a href="package-reshape.html"><i class="fa fa-check"></i><b>18</b> Package <code>reshape</code></a>
<ul>
<li class="chapter" data-level="18.1" data-path="package-reshape.html"><a href="package-reshape.html#melting-data"><i class="fa fa-check"></i><b>18.1</b> Melting data</a></li>
<li class="chapter" data-level="18.2" data-path="package-reshape.html"><a href="package-reshape.html#casting-molten-data"><i class="fa fa-check"></i><b>18.2</b> Casting molten data</a></li>
<li class="chapter" data-level="18.3" data-path="package-reshape.html"><a href="package-reshape.html#the-french-fries-example"><i class="fa fa-check"></i><b>18.3</b> The French Fries Example</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="package-reshape2.html"><a href="package-reshape2.html"><i class="fa fa-check"></i><b>19</b> Package <code>reshape2</code></a></li>
<li class="chapter" data-level="20" data-path="reshaping-data.html"><a href="reshaping-data.html"><i class="fa fa-check"></i><b>20</b> Reshaping Data</a>
<ul>
<li class="chapter" data-level="20.1" data-path="reshaping-data.html"><a href="reshaping-data.html#modifying-data-frame-variables"><i class="fa fa-check"></i><b>20.1</b> Modifying data frame variables</a></li>
<li class="chapter" data-level="20.2" data-path="reshaping-data.html"><a href="reshaping-data.html#reshaping-a-data-frame"><i class="fa fa-check"></i><b>20.2</b> Reshaping a data frame</a></li>
<li class="chapter" data-level="20.3" data-path="reshaping-data.html"><a href="reshaping-data.html#function-reshape"><i class="fa fa-check"></i><b>20.3</b> Function <code>reshape</code></a></li>
<li class="chapter" data-level="20.4" data-path="reshaping-data.html"><a href="reshaping-data.html#combining-data-frames"><i class="fa fa-check"></i><b>20.4</b> Combining Data Frames</a></li>
<li class="chapter" data-level="20.5" data-path="reshaping-data.html"><a href="reshaping-data.html#merging-using-index"><i class="fa fa-check"></i><b>20.5</b> Merging using index</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="a-quick-review.html"><a href="a-quick-review.html"><i class="fa fa-check"></i><b>21</b> A quick review</a>
<ul>
<li class="chapter" data-level="21.1" data-path="a-quick-review.html"><a href="a-quick-review.html#data-in-r"><i class="fa fa-check"></i><b>21.1</b> Data in R</a></li>
<li class="chapter" data-level="21.2" data-path="a-quick-review.html"><a href="a-quick-review.html#reading-and-writing-data"><i class="fa fa-check"></i><b>21.2</b> Reading and writing data</a></li>
<li class="chapter" data-level="21.3" data-path="a-quick-review.html"><a href="a-quick-review.html#dates"><i class="fa fa-check"></i><b>21.3</b> Dates</a></li>
<li class="chapter" data-level="21.4" data-path="a-quick-review.html"><a href="a-quick-review.html#subscripting-1"><i class="fa fa-check"></i><b>21.4</b> Subscripting</a></li>
<li class="chapter" data-level="21.5" data-path="a-quick-review.html"><a href="a-quick-review.html#data-aggregation"><i class="fa fa-check"></i><b>21.5</b> Data aggregation</a></li>
<li class="chapter" data-level="21.6" data-path="a-quick-review.html"><a href="a-quick-review.html#data-reshaping"><i class="fa fa-check"></i><b>21.6</b> Data reshaping</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="introduction-3.html"><a href="introduction-3.html"><i class="fa fa-check"></i><b>22</b> Introduction</a>
<ul>
<li class="chapter" data-level="22.1" data-path="introduction-3.html"><a href="introduction-3.html#example-1"><i class="fa fa-check"></i><b>22.1</b> Example 1:</a></li>
<li class="chapter" data-level="22.2" data-path="introduction-3.html"><a href="introduction-3.html#example-2"><i class="fa fa-check"></i><b>22.2</b> Example 2:</a></li>
<li class="chapter" data-level="22.3" data-path="introduction-3.html"><a href="introduction-3.html#example-4"><i class="fa fa-check"></i><b>22.3</b> Example 4:</a></li>
<li class="chapter" data-level="22.4" data-path="introduction-3.html"><a href="introduction-3.html#example-5"><i class="fa fa-check"></i><b>22.4</b> Example 5:</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="types-of-arguments.html"><a href="types-of-arguments.html"><i class="fa fa-check"></i><b>23</b> Types of arguments</a>
<ul>
<li class="chapter" data-level="23.1" data-path="types-of-arguments.html"><a href="types-of-arguments.html#example-6"><i class="fa fa-check"></i><b>23.1</b> Example 6:</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="default-arguments.html"><a href="default-arguments.html"><i class="fa fa-check"></i><b>24</b> Default arguments</a>
<ul>
<li class="chapter" data-level="24.1" data-path="default-arguments.html"><a href="default-arguments.html#example-7"><i class="fa fa-check"></i><b>24.1</b> Example 7:</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="recursive-function.html"><a href="recursive-function.html"><i class="fa fa-check"></i><b>25</b> Recursive Function</a></li>
<li class="chapter" data-level="26" data-path="two-real-example.html"><a href="two-real-example.html"><i class="fa fa-check"></i><b>26</b> Two Real Example</a>
<ul>
<li class="chapter" data-level="26.1" data-path="two-real-example.html"><a href="two-real-example.html#importing-elisa-test-data"><i class="fa fa-check"></i><b>26.1</b> Importing ELISA Test Data</a></li>
<li class="chapter" data-level="26.2" data-path="two-real-example.html"><a href="two-real-example.html#the-hockey-stick-model"><i class="fa fa-check"></i><b>26.2</b> The Hockey Stick Model</a></li>
<li class="chapter" data-level="26.3" data-path="two-real-example.html"><a href="two-real-example.html#sparrow-model"><i class="fa fa-check"></i><b>26.3</b> SPARROW model</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="good-function-writing-practices.html"><a href="good-function-writing-practices.html"><i class="fa fa-check"></i><b>27</b> Good function writing practices</a></li>
<li class="chapter" data-level="28" data-path="package-tidyr.html"><a href="package-tidyr.html"><i class="fa fa-check"></i><b>28</b> Package <code>tidyr</code></a></li>
<li class="chapter" data-level="29" data-path="package-reshape2-1.html"><a href="package-reshape2-1.html"><i class="fa fa-check"></i><b>29</b> Package <code>reshape2</code></a>
<ul>
<li class="chapter" data-level="29.1" data-path="package-reshape2-1.html"><a href="package-reshape2-1.html#long-versus-wide"><i class="fa fa-check"></i><b>29.1</b> Long versus Wide</a></li>
<li class="chapter" data-level="29.2" data-path="package-reshape2-1.html"><a href="package-reshape2-1.html#reshape2"><i class="fa fa-check"></i><b>29.2</b> <code>reshape2</code></a>
<ul>
<li class="chapter" data-level="29.2.1" data-path="package-reshape2-1.html"><a href="package-reshape2-1.html#wide--to-long-format-data-the-melt-function"><i class="fa fa-check"></i><b>29.2.1</b> Wide- to long-format data: the <code>melt</code> function</a></li>
<li class="chapter" data-level="29.2.2" data-path="package-reshape2-1.html"><a href="package-reshape2-1.html#long--to-wide-format-data-the-cast-functions"><i class="fa fa-check"></i><b>29.2.2</b> Long- to wide-format data: the cast functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="tidyr-versus-reshape2.html"><a href="tidyr-versus-reshape2.html"><i class="fa fa-check"></i><b>30</b> <code>tidyr</code> versus <code>reshape2</code></a>
<ul>
<li class="chapter" data-level="30.1" data-path="tidyr-versus-reshape2.html"><a href="tidyr-versus-reshape2.html#data-tidying"><i class="fa fa-check"></i><b>30.1</b> Data tidying</a>
<ul>
<li class="chapter" data-level="30.1.1" data-path="tidyr-versus-reshape2.html"><a href="tidyr-versus-reshape2.html#from-the-wide-to-the-long-format-gather-vs-melt"><i class="fa fa-check"></i><b>30.1.1</b> From the wide to the long format: <code>gather()</code> vs <code>melt()</code></a></li>
<li class="chapter" data-level="30.1.2" data-path="tidyr-versus-reshape2.html"><a href="tidyr-versus-reshape2.html#split-a-column-separate-vs-colsplit"><i class="fa fa-check"></i><b>30.1.2</b> Split a column: <code>separate()</code> vs <code>colsplit()</code></a></li>
<li class="chapter" data-level="30.1.3" data-path="tidyr-versus-reshape2.html"><a href="tidyr-versus-reshape2.html#from-the-long-to-the-wide-format-spread-vs-dcast"><i class="fa fa-check"></i><b>30.1.3</b> From the long to the wide format: <code>spread()</code> vs <code>dcast()</code></a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="tidyr-versus-reshape2.html"><a href="tidyr-versus-reshape2.html#data-aggregation-1"><i class="fa fa-check"></i><b>30.2</b> Data aggregation</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="factors.html"><a href="factors.html"><i class="fa fa-check"></i><b>31</b> Factors</a>
<ul>
<li class="chapter" data-level="31.1" data-path="factors.html"><a href="factors.html#numeric-factors"><i class="fa fa-check"></i><b>31.1</b> Numeric Factors</a></li>
<li class="chapter" data-level="31.2" data-path="factors.html"><a href="factors.html#manipulating-factors"><i class="fa fa-check"></i><b>31.2</b> Manipulating Factors</a></li>
<li class="chapter" data-level="31.3" data-path="factors.html"><a href="factors.html#creating-factors-from-continuous-variables"><i class="fa fa-check"></i><b>31.3</b> Creating Factors from Continuous Variables</a></li>
<li class="chapter" data-level="31.4" data-path="factors.html"><a href="factors.html#factors-based-on-dates-and-times"><i class="fa fa-check"></i><b>31.4</b> Factors Based on Dates and Times</a></li>
<li class="chapter" data-level="31.5" data-path="factors.html"><a href="factors.html#interactions"><i class="fa fa-check"></i><b>31.5</b> Interactions</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="character-manipulation.html"><a href="character-manipulation.html"><i class="fa fa-check"></i><b>32</b> Character Manipulation</a>
<ul>
<li class="chapter" data-level="32.1" data-path="character-manipulation.html"><a href="character-manipulation.html#regular-expressions-in-r"><i class="fa fa-check"></i><b>32.1</b> Regular Expressions in R</a></li>
<li class="chapter" data-level="32.2" data-path="character-manipulation.html"><a href="character-manipulation.html#breaking-apart-character-values"><i class="fa fa-check"></i><b>32.2</b> Breaking Apart Character Values</a></li>
<li class="chapter" data-level="32.3" data-path="character-manipulation.html"><a href="character-manipulation.html#substitutions-and-tagging"><i class="fa fa-check"></i><b>32.3</b> Substitutions and Tagging</a></li>
<li class="chapter" data-level="32.4" data-path="character-manipulation.html"><a href="character-manipulation.html#a-quick-summary"><i class="fa fa-check"></i><b>32.4</b> A Quick Summary</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="introduction-4.html"><a href="introduction-4.html"><i class="fa fa-check"></i><b>33</b> Introduction</a></li>
<li class="chapter" data-level="34" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>34</b> Examples</a>
<ul>
<li class="chapter" data-level="34.1" data-path="examples.html"><a href="examples.html#example-1-1"><i class="fa fa-check"></i><b>34.1</b> Example 1</a></li>
<li class="chapter" data-level="34.2" data-path="examples.html"><a href="examples.html#example-2-1"><i class="fa fa-check"></i><b>34.2</b> Example 2</a></li>
<li class="chapter" data-level="34.3" data-path="examples.html"><a href="examples.html#using-lattice-package"><i class="fa fa-check"></i><b>34.3</b> Using Lattice Package</a></li>
<li class="chapter" data-level="34.4" data-path="examples.html"><a href="examples.html#using-lattice-functions"><i class="fa fa-check"></i><b>34.4</b> Using Lattice Functions</a></li>
<li class="chapter" data-level="34.5" data-path="examples.html"><a href="examples.html#custom-panel-functions"><i class="fa fa-check"></i><b>34.5</b> Custom Panel Functions</a></li>
<li class="chapter" data-level="34.6" data-path="examples.html"><a href="examples.html#the-example-that-started-trellis"><i class="fa fa-check"></i><b>34.6</b> The Example That Started Trellis</a></li>
<li class="chapter" data-level="34.7" data-path="examples.html"><a href="examples.html#an-example-of-graphical-exploratory-data-analysis"><i class="fa fa-check"></i><b>34.7</b> An Example of Graphical Exploratory Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="introduction-5.html"><a href="introduction-5.html"><i class="fa fa-check"></i><b>35</b> Introduction</a></li>
<li class="chapter" data-level="36" data-path="examples-1.html"><a href="examples-1.html"><i class="fa fa-check"></i><b>36</b> Examples</a>
<ul>
<li class="chapter" data-level="36.1" data-path="examples-1.html"><a href="examples-1.html#example-1-2"><i class="fa fa-check"></i><b>36.1</b> Example 1</a></li>
<li class="chapter" data-level="36.2" data-path="examples-1.html"><a href="examples-1.html#example-2-2"><i class="fa fa-check"></i><b>36.2</b> Example 2</a></li>
<li class="chapter" data-level="36.3" data-path="examples-1.html"><a href="examples-1.html#using-lattice-package-1"><i class="fa fa-check"></i><b>36.3</b> Using Lattice Package</a></li>
<li class="chapter" data-level="36.4" data-path="examples-1.html"><a href="examples-1.html#using-lattice-functions-1"><i class="fa fa-check"></i><b>36.4</b> Using Lattice Functions</a></li>
<li class="chapter" data-level="36.5" data-path="examples-1.html"><a href="examples-1.html#costom-panel-functions"><i class="fa fa-check"></i><b>36.5</b> Costom Panel Functions</a></li>
<li class="chapter" data-level="36.6" data-path="examples-1.html"><a href="examples-1.html#the-example-that-started-trellis-1"><i class="fa fa-check"></i><b>36.6</b> The Example That Started Trellis</a></li>
<li class="chapter" data-level="36.7" data-path="examples-1.html"><a href="examples-1.html#an-example-of-graphical-exploratory-data-analysis-1"><i class="fa fa-check"></i><b>36.7</b> An Example of Graphical Exploratory Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="introduction-6.html"><a href="introduction-6.html"><i class="fa fa-check"></i><b>37</b> Introduction</a>
<ul>
<li class="chapter" data-level="37.1" data-path="introduction-6.html"><a href="introduction-6.html#filter"><i class="fa fa-check"></i><b>37.1</b> Filter</a></li>
<li class="chapter" data-level="37.2" data-path="introduction-6.html"><a href="introduction-6.html#mutate"><i class="fa fa-check"></i><b>37.2</b> Mutate</a></li>
<li class="chapter" data-level="37.3" data-path="introduction-6.html"><a href="introduction-6.html#summarise"><i class="fa fa-check"></i><b>37.3</b> Summarise</a></li>
<li class="chapter" data-level="37.4" data-path="introduction-6.html"><a href="introduction-6.html#group-by"><i class="fa fa-check"></i><b>37.4</b> Group By</a></li>
<li class="chapter" data-level="37.5" data-path="introduction-6.html"><a href="introduction-6.html#sample"><i class="fa fa-check"></i><b>37.5</b> Sample</a></li>
<li class="chapter" data-level="37.6" data-path="introduction-6.html"><a href="introduction-6.html#count"><i class="fa fa-check"></i><b>37.6</b> Count</a></li>
<li class="chapter" data-level="37.7" data-path="introduction-6.html"><a href="introduction-6.html#arrange"><i class="fa fa-check"></i><b>37.7</b> Arrange</a></li>
<li class="chapter" data-level="37.8" data-path="introduction-6.html"><a href="introduction-6.html#pipe"><i class="fa fa-check"></i><b>37.8</b> Pipe</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html"><i class="fa fa-check"></i><b>38</b> Explaining <code>dplyr</code> – A More Complicated Example</a>
<ul>
<li class="chapter" data-level="38.1" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#data-nycflights13"><i class="fa fa-check"></i><b>38.1</b> Data: <code>nycflights13</code></a></li>
<li class="chapter" data-level="38.2" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#single-table-verbs"><i class="fa fa-check"></i><b>38.2</b> Single table verbs</a></li>
<li class="chapter" data-level="38.3" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#filter-rows-with-filter-1"><i class="fa fa-check"></i><b>38.3</b> Filter rows with <code>filter()</code></a></li>
<li class="chapter" data-level="38.4" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#arrange-rows-with-arrange-1"><i class="fa fa-check"></i><b>38.4</b> Arrange rows with <code>arrange()</code></a></li>
<li class="chapter" data-level="38.5" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#select-columns-with-select"><i class="fa fa-check"></i><b>38.5</b> Select columns with <code>select()</code></a></li>
<li class="chapter" data-level="38.6" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#extract-distinct-unique-rows"><i class="fa fa-check"></i><b>38.6</b> Extract distinct (unique) rows</a></li>
<li class="chapter" data-level="38.7" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#add-new-columns-with-mutate"><i class="fa fa-check"></i><b>38.7</b> Add new columns with mutate()</a></li>
<li class="chapter" data-level="38.8" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#summarise-values-with-summarise"><i class="fa fa-check"></i><b>38.8</b> Summarise values with <code>summarise()</code></a></li>
<li class="chapter" data-level="38.9" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#randomly-sample-rows-with-sample_n-and-sample_frac"><i class="fa fa-check"></i><b>38.9</b> Randomly sample rows with sample_n() and sample_frac()</a></li>
<li class="chapter" data-level="38.10" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#commonalities"><i class="fa fa-check"></i><b>38.10</b> Commonalities</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="grouped-operations.html"><a href="grouped-operations.html"><i class="fa fa-check"></i><b>39</b> Grouped operations</a>
<ul>
<li class="chapter" data-level="39.1" data-path="grouped-operations.html"><a href="grouped-operations.html#chaining"><i class="fa fa-check"></i><b>39.1</b> Chaining</a></li>
<li class="chapter" data-level="39.2" data-path="grouped-operations.html"><a href="grouped-operations.html#a-quick-summary-1"><i class="fa fa-check"></i><b>39.2</b> A quick Summary</a>
<ul>
<li class="chapter" data-level="39.2.1" data-path="grouped-operations.html"><a href="grouped-operations.html#dplyr-verbs-in-action"><i class="fa fa-check"></i><b>39.2.1</b> dplyr verbs in action</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="40" data-path="a-quick-recap.html"><a href="a-quick-recap.html"><i class="fa fa-check"></i><b>40</b> A Quick Recap</a>
<ul>
<li class="chapter" data-level="40.1" data-path="a-quick-recap.html"><a href="a-quick-recap.html#costom-panel-functions-1"><i class="fa fa-check"></i><b>40.1</b> Costom Panel Functions</a></li>
<li class="chapter" data-level="40.2" data-path="a-quick-recap.html"><a href="a-quick-recap.html#the-example-that-started-trellis-2"><i class="fa fa-check"></i><b>40.2</b> The Example That Started Trellis</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="types-of-data.html"><a href="types-of-data.html"><i class="fa fa-check"></i><b>41</b> Types of Data</a>
<ul>
<li class="chapter" data-level="41.1" data-path="types-of-data.html"><a href="types-of-data.html#univariate-data"><i class="fa fa-check"></i><b>41.1</b> Univariate data</a></li>
<li class="chapter" data-level="41.2" data-path="types-of-data.html"><a href="types-of-data.html#fits-and-residuals"><i class="fa fa-check"></i><b>41.2</b> Fits and Residuals</a>
<ul>
<li class="chapter" data-level="41.2.1" data-path="types-of-data.html"><a href="types-of-data.html#homogeneity-and-pooling"><i class="fa fa-check"></i><b>41.2.1</b> Homogeneity and Pooling</a></li>
<li class="chapter" data-level="41.2.2" data-path="types-of-data.html"><a href="types-of-data.html#checking-for-normality-of-the-pooled-residuals"><i class="fa fa-check"></i><b>41.2.2</b> Checking for normality of the pooled residuals</a></li>
<li class="chapter" data-level="41.2.3" data-path="types-of-data.html"><a href="types-of-data.html#the-rfs-plot"><i class="fa fa-check"></i><b>41.2.3</b> The <code>rfs</code> plot</a></li>
</ul></li>
<li class="chapter" data-level="41.3" data-path="types-of-data.html"><a href="types-of-data.html#bivariate-data"><i class="fa fa-check"></i><b>41.3</b> Bivariate data</a></li>
<li class="chapter" data-level="41.4" data-path="types-of-data.html"><a href="types-of-data.html#trivariate-and-hypervariate-data"><i class="fa fa-check"></i><b>41.4</b> Trivariate and hypervariate data</a></li>
<li class="chapter" data-level="41.5" data-path="types-of-data.html"><a href="types-of-data.html#multiway-data"><i class="fa fa-check"></i><b>41.5</b> Multiway data</a></li>
</ul></li>
<li class="chapter" data-level="42" data-path="univariate-data-displaying-and-comparing-distributions.html"><a href="univariate-data-displaying-and-comparing-distributions.html"><i class="fa fa-check"></i><b>42</b> Univariate Data – Displaying and Comparing Distributions</a>
<ul>
<li class="chapter" data-level="42.1" data-path="univariate-data-displaying-and-comparing-distributions.html"><a href="univariate-data-displaying-and-comparing-distributions.html#displaying-distribution"><i class="fa fa-check"></i><b>42.1</b> Displaying distribution</a></li>
<li class="chapter" data-level="42.2" data-path="univariate-data-displaying-and-comparing-distributions.html"><a href="univariate-data-displaying-and-comparing-distributions.html#comparing-distributions"><i class="fa fa-check"></i><b>42.2</b> Comparing distributions</a></li>
<li class="chapter" data-level="42.3" data-path="univariate-data-displaying-and-comparing-distributions.html"><a href="univariate-data-displaying-and-comparing-distributions.html#an-example-of-graphical-exploratory-data-analysis-2"><i class="fa fa-check"></i><b>42.3</b> An Example of Graphical Exploratory Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="43" data-path="a-summary.html"><a href="a-summary.html"><i class="fa fa-check"></i><b>43</b> A Summary</a>
<ul>
<li class="chapter" data-level="43.1" data-path="a-summary.html"><a href="a-summary.html#types-of-data-1"><i class="fa fa-check"></i><b>43.1</b> Types of Data</a>
<ul>
<li class="chapter" data-level="43.1.1" data-path="a-summary.html"><a href="a-summary.html#checking-for-normality-of-the-pooled-residuals-1"><i class="fa fa-check"></i><b>43.1.1</b> Checking for normality of the pooled residuals</a></li>
<li class="chapter" data-level="43.1.2" data-path="a-summary.html"><a href="a-summary.html#the-rfs-plot-1"><i class="fa fa-check"></i><b>43.1.2</b> The <code>rfs</code> plot</a></li>
</ul></li>
<li class="chapter" data-level="43.2" data-path="a-summary.html"><a href="a-summary.html#additive-versus-multiplicative-shifts"><i class="fa fa-check"></i><b>43.2</b> Additive versus multiplicative shifts</a></li>
<li class="chapter" data-level="43.3" data-path="a-summary.html"><a href="a-summary.html#using-q-q-plot-to-check-for-additive-shift"><i class="fa fa-check"></i><b>43.3</b> Using Q-Q plot to Check for Additive Shift</a></li>
<li class="chapter" data-level="43.4" data-path="a-summary.html"><a href="a-summary.html#transformation-to-normality"><i class="fa fa-check"></i><b>43.4</b> Transformation to Normality</a></li>
<li class="chapter" data-level="43.5" data-path="a-summary.html"><a href="a-summary.html#an-example-of-graphical-exploratory-data-analysis-3"><i class="fa fa-check"></i><b>43.5</b> An Example of Graphical Exploratory Data Analysis</a></li>
<li class="chapter" data-level="43.6" data-path="a-summary.html"><a href="a-summary.html#nutrient-loading-and-flow-from-maumee"><i class="fa fa-check"></i><b>43.6</b> Nutrient Loading and Flow from Maumee</a>
<ul>
<li class="chapter" data-level="43.6.1" data-path="a-summary.html"><a href="a-summary.html#objectives"><i class="fa fa-check"></i><b>43.6.1</b> Objectives</a></li>
<li class="chapter" data-level="43.6.2" data-path="a-summary.html"><a href="a-summary.html#methods"><i class="fa fa-check"></i><b>43.6.2</b> Methods</a></li>
<li class="chapter" data-level="43.6.3" data-path="a-summary.html"><a href="a-summary.html#results"><i class="fa fa-check"></i><b>43.6.3</b> Results</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Environmental Data Management</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="examples-1" class="section level1" number="36">
<h1><span class="header-section-number">36</span> Examples</h1>
<div id="example-1-2" class="section level2" number="36.1">
<h2><span class="header-section-number">36.1</span> Example 1</h2>
<p>Daily PM2.5 concentration data from a station in Maltomore MD is used to study the distribution and trend of air pollution in an urban center.</p>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="examples-1.html#cb834-1" aria-hidden="true" tabindex="-1"></a>pmdata<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="fu">paste</span> (dataDIR, <span class="st">&quot;PM-RAW-DATA.txt&quot;</span>, <span class="at">sep=</span><span class="st">&quot;/&quot;</span>),<span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb834-2"><a href="examples-1.html#cb834-2" aria-hidden="true" tabindex="-1"></a>pmdata<span class="sc">$</span>rain<span class="ot">&lt;-</span>pmdata<span class="sc">$</span>Precip <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb834-3"><a href="examples-1.html#cb834-3" aria-hidden="true" tabindex="-1"></a>pmdata<span class="sc">$</span>log.wind<span class="ot">&lt;-</span><span class="fu">log</span>(pmdata<span class="sc">$</span>AvgWind)</span>
<span id="cb834-4"><a href="examples-1.html#cb834-4" aria-hidden="true" tabindex="-1"></a>pmdata<span class="sc">$</span>z.log.wind<span class="ot">&lt;-</span><span class="fu">as.vector</span>(<span class="fu">scale</span>(pmdata<span class="sc">$</span>log.wind))</span>
<span id="cb834-5"><a href="examples-1.html#cb834-5" aria-hidden="true" tabindex="-1"></a>pmdata<span class="sc">$</span>z.temp<span class="ot">&lt;-</span><span class="fu">as.vector</span>(<span class="fu">scale</span>(pmdata<span class="sc">$</span>AvgTemp))</span>
<span id="cb834-6"><a href="examples-1.html#cb834-6" aria-hidden="true" tabindex="-1"></a>pmdata<span class="sc">$</span>log.value<span class="ot">&lt;-</span><span class="fu">log</span>(pmdata<span class="sc">$</span>value)</span>
<span id="cb834-7"><a href="examples-1.html#cb834-7" aria-hidden="true" tabindex="-1"></a><span class="do">## dates were recorded as days since Jan. 1, 2003</span></span>
<span id="cb834-8"><a href="examples-1.html#cb834-8" aria-hidden="true" tabindex="-1"></a>pmdata<span class="sc">$</span>Dates <span class="ot">&lt;-</span>  <span class="fu">as.Date</span>(<span class="st">&quot;2003-01-01&quot;</span>) <span class="sc">+</span> pmdata<span class="sc">$</span>date<span class="dv">-1</span></span>
<span id="cb834-9"><a href="examples-1.html#cb834-9" aria-hidden="true" tabindex="-1"></a>pmdata<span class="sc">$</span>Weekday <span class="ot">&lt;-</span> <span class="fu">weekdays</span>(pmdata<span class="sc">$</span>Dates, <span class="at">abbreviate=</span>T)</span>
<span id="cb834-10"><a href="examples-1.html#cb834-10" aria-hidden="true" tabindex="-1"></a>pmdata<span class="sc">$</span>Month <span class="ot">&lt;-</span> <span class="fu">ordered</span>(<span class="fu">months</span>(pmdata<span class="sc">$</span>Dates, T), <span class="at">levels=</span>month.abb)</span></code></pre></div>
<p>One question asked was whether PM2.5 is a function of temperature.</p>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="examples-1.html#cb835-1" aria-hidden="true" tabindex="-1"></a>obj1<span class="ot">&lt;-</span><span class="fu">xyplot</span>(log.value<span class="sc">~</span>AvgTemp, <span class="at">panel=</span><span class="cf">function</span>(x,y,...){</span>
<span id="cb835-2"><a href="examples-1.html#cb835-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">panel.grid</span>()</span>
<span id="cb835-3"><a href="examples-1.html#cb835-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">panel.xyplot</span>(x,y, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.65</span>), <span class="at">cex=</span><span class="fl">0.25</span>, ...)</span>
<span id="cb835-4"><a href="examples-1.html#cb835-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">panel.loess</span>(x,y,<span class="at">span=</span><span class="dv">1</span>, <span class="at">degree=</span><span class="dv">1</span>,<span class="at">col=</span><span class="dv">1</span>,...)</span>
<span id="cb835-5"><a href="examples-1.html#cb835-5" aria-hidden="true" tabindex="-1"></a>},    <span class="at">scales=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">0.75</span>, <span class="at">tck=</span><span class="fl">0.2</span>), <span class="at">y=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">0.75</span>, <span class="at">tck=</span><span class="fl">0.2</span>)),</span>
<span id="cb835-6"><a href="examples-1.html#cb835-6" aria-hidden="true" tabindex="-1"></a><span class="do">##               par.settings=trellis.par.temp,</span></span>
<span id="cb835-7"><a href="examples-1.html#cb835-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">data=</span>pmdata, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Log PM2.5&quot;</span>)</span>
<span id="cb835-8"><a href="examples-1.html#cb835-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(obj1)</span></code></pre></div>
<p><img src="lattice_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>At the first glance, we may conclude that PM2.5 is not related to temperature. The slightly higher PM2.5 at the right end of the graph could be explained by the higher level of traffic in summer. To see if seasonality is the explanation of the small positive correlation, we can plot PM2.5 by month:</p>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb836-1"><a href="examples-1.html#cb836-1" aria-hidden="true" tabindex="-1"></a>obj2 <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(log.value<span class="sc">~</span>AvgTemp<span class="sc">|</span>Month, <span class="at">panel=</span><span class="cf">function</span>(x,y,...){</span>
<span id="cb836-2"><a href="examples-1.html#cb836-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">panel.grid</span>()</span>
<span id="cb836-3"><a href="examples-1.html#cb836-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">panel.xyplot</span>(x,y, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.65</span>), <span class="at">cex=</span><span class="fl">0.25</span>, ...)</span>
<span id="cb836-4"><a href="examples-1.html#cb836-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">panel.loess</span>(x,y,<span class="at">span=</span><span class="dv">1</span>, <span class="at">degree=</span><span class="dv">1</span>,<span class="at">col=</span><span class="dv">1</span>,...)</span>
<span id="cb836-5"><a href="examples-1.html#cb836-5" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">1</span>),</span>
<span id="cb836-6"><a href="examples-1.html#cb836-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">scales=</span><span class="fu">list</span>(<span class="at">y=</span><span class="fu">list</span>(<span class="at">tck=</span><span class="fl">0.2</span>),</span>
<span id="cb836-7"><a href="examples-1.html#cb836-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">x=</span><span class="fu">list</span>(<span class="at">relation=</span><span class="st">&quot;free&quot;</span>, <span class="at">cex=</span><span class="fl">0.3</span>,<span class="at">tck=</span><span class="fl">0.2</span>, <span class="at">alternating=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))),</span>
<span id="cb836-8"><a href="examples-1.html#cb836-8" aria-hidden="true" tabindex="-1"></a>       <span class="do">## x-axis relation and font size</span></span>
<span id="cb836-9"><a href="examples-1.html#cb836-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">##par.settings=trellis.par.temp,</span></span>
<span id="cb836-10"><a href="examples-1.html#cb836-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>pmdata, <span class="at">xlab=</span><span class="st">&quot;Average Daily Temperature (F)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Log PM2.5&quot;</span>)</span>
<span id="cb836-11"><a href="examples-1.html#cb836-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(obj2)</span></code></pre></div>
<p><img src="lattice_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Plotting the PM2.5 versus temperature scatter plot by month, is a form of conditional plot: a two dimensional relationship is conditional on season.</p>
<p>We can put these two figures together:</p>
<div class="sourceCode" id="cb837"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb837-1"><a href="examples-1.html#cb837-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(obj1, <span class="at">position=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="fl">0.3</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span>), <span class="at">more=</span>T)</span>
<span id="cb837-2"><a href="examples-1.html#cb837-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(obj2, <span class="at">position=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="fl">0.35</span>), <span class="at">more=</span>F)</span></code></pre></div>
<p><img src="lattice_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>While it is natural to think of the PM2.5 versus temperature conditional on month, the conditioning concept can be applied to any high dimensional data. Let’s take a look of the second example.</p>
</div>
<div id="example-2-2" class="section level2" number="36.2">
<h2><span class="header-section-number">36.2</span> Example 2</h2>
<p>Air quality data from R:</p>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="examples-1.html#cb838-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(airquality)</span>
<span id="cb838-2"><a href="examples-1.html#cb838-2" aria-hidden="true" tabindex="-1"></a><span class="fu">splom</span>(airquality[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span></code></pre></div>
<p><img src="lattice_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb839-1"><a href="examples-1.html#cb839-1" aria-hidden="true" tabindex="-1"></a><span class="do">## compared to:</span></span>
<span id="cb839-2"><a href="examples-1.html#cb839-2" aria-hidden="true" tabindex="-1"></a><span class="do">## pairs(Ozone~Solar.R+Wind+Temp, data=airquality)</span></span></code></pre></div>
<p>This is a 4-dimensional data. Ozone concentrations are affected by all three variables. Scatter plots are not adequate to show multidimensional interactions. The concept of interaction is difficult to visualize.</p>
<p>A conditional plot is a tool for using multipanel bivariate scatter plot to explore the interactions among multiple variables. The definition of an interaction is that the effect of one variable varies depending on the value of a second variable. For example, ozone concentration and wind speed has a negative correlation. If the slope changes as a function of temperature, we say that there is an interaction effect between wind and temperature. To visualize the interaction effect, we can use a 3-dimensional plot. But a 3-D plot is always difficult to show on a 2-D surface. Bill Cleveland suggested that we can visualizing an interaction effect by using multiple scatter plots. For example, to visualize the interaction effect between temperature and wind, we can divide the data into a number of subsets by temperature (temperature low, median, high). For each subset, we plot ozone against wind.</p>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb840-1"><a href="examples-1.html#cb840-1" aria-hidden="true" tabindex="-1"></a>Temperature <span class="ot">&lt;-</span> <span class="fu">equal.count</span>(airquality<span class="sc">$</span>Temp, <span class="dv">3</span>, <span class="fl">0.25</span>)</span>
<span id="cb840-2"><a href="examples-1.html#cb840-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(<span class="fu">sqrt</span>(Ozone) <span class="sc">~</span> Wind<span class="sc">|</span>Temperature,</span>
<span id="cb840-3"><a href="examples-1.html#cb840-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">data=</span>airquality,</span>
<span id="cb840-4"><a href="examples-1.html#cb840-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel=</span><span class="cf">function</span>(x,y,...){</span>
<span id="cb840-5"><a href="examples-1.html#cb840-5" aria-hidden="true" tabindex="-1"></a><span class="co">#            panel.loess(x, y, span=1, degree=1, ...)</span></span>
<span id="cb840-6"><a href="examples-1.html#cb840-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.grid</span>()</span>
<span id="cb840-7"><a href="examples-1.html#cb840-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.lmline</span>(x, y, <span class="at">col=</span><span class="st">&quot;grey&quot;</span>,...)</span>
<span id="cb840-8"><a href="examples-1.html#cb840-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.xyplot</span>(x, y, <span class="at">col=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.5</span>, ...)</span>
<span id="cb840-9"><a href="examples-1.html#cb840-9" aria-hidden="true" tabindex="-1"></a>       },</span>
<span id="cb840-10"><a href="examples-1.html#cb840-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">aspect=</span><span class="dv">1</span>,</span>
<span id="cb840-11"><a href="examples-1.html#cb840-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab=</span><span class="fu">list</span>(<span class="at">label=</span><span class="st">&quot;Sqrt Ozone&quot;</span>, <span class="at">cex=</span><span class="fl">0.6</span>),</span>
<span id="cb840-12"><a href="examples-1.html#cb840-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="fu">list</span>(<span class="at">label=</span><span class="st">&quot;Wind Speed&quot;</span>, <span class="at">cex=</span><span class="fl">0.6</span>)</span>
<span id="cb840-13"><a href="examples-1.html#cb840-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="lattice_files/figure-html/unnamed-chunk-9-1.png" width="672" />
We now see that the effect of wind increases as temperature increases.</p>
<p>Likewise, we can examine the effect of temperature conditional on wind:</p>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb841-1"><a href="examples-1.html#cb841-1" aria-hidden="true" tabindex="-1"></a>Wind_Speed <span class="ot">&lt;-</span> <span class="fu">equal.count</span>(airquality<span class="sc">$</span>Wind, <span class="dv">3</span>, <span class="fl">0.25</span>)</span>
<span id="cb841-2"><a href="examples-1.html#cb841-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(<span class="fu">sqrt</span>(Ozone) <span class="sc">~</span> Temp<span class="sc">|</span>Wind_Speed,</span>
<span id="cb841-3"><a href="examples-1.html#cb841-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">data=</span>airquality,</span>
<span id="cb841-4"><a href="examples-1.html#cb841-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel=</span><span class="cf">function</span>(x,y,...){</span>
<span id="cb841-5"><a href="examples-1.html#cb841-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.loess</span>(x, y, <span class="at">span=</span><span class="dv">1</span>, <span class="at">degree=</span><span class="dv">1</span>, ...)</span>
<span id="cb841-6"><a href="examples-1.html#cb841-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.grid</span>()</span>
<span id="cb841-7"><a href="examples-1.html#cb841-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.lmline</span>(x, y, <span class="at">col=</span><span class="st">&quot;grey&quot;</span>,...)</span>
<span id="cb841-8"><a href="examples-1.html#cb841-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.xyplot</span>(x, y, <span class="at">col=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.5</span>, ...)</span>
<span id="cb841-9"><a href="examples-1.html#cb841-9" aria-hidden="true" tabindex="-1"></a>       },</span>
<span id="cb841-10"><a href="examples-1.html#cb841-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">aspect=</span><span class="dv">1</span>,</span>
<span id="cb841-11"><a href="examples-1.html#cb841-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab=</span><span class="fu">list</span>(<span class="at">label=</span><span class="st">&quot;Sqrt Ozone&quot;</span>, <span class="at">cex=</span><span class="fl">0.6</span>),</span>
<span id="cb841-12"><a href="examples-1.html#cb841-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="fu">list</span>(<span class="at">label=</span><span class="st">&quot;Temperature&quot;</span>, <span class="at">cex=</span><span class="fl">0.6</span>)</span>
<span id="cb841-13"><a href="examples-1.html#cb841-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="lattice_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>As wind speed increases, the effect of temperature decreases.</p>
<p>What about the effect of solar radiation? Can we visualize a three way interaction?</p>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="examples-1.html#cb842-1" aria-hidden="true" tabindex="-1"></a>Solar_R <span class="ot">&lt;-</span> <span class="fu">equal.count</span>(airquality<span class="sc">$</span>Solar.R, <span class="dv">3</span>, <span class="fl">0.25</span>)</span>
<span id="cb842-2"><a href="examples-1.html#cb842-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb842-3"><a href="examples-1.html#cb842-3" aria-hidden="true" tabindex="-1"></a><span class="fu">trellis.par.set</span>(<span class="at">theme =</span> <span class="fu">canonical.theme</span>(<span class="st">&quot;postscript&quot;</span>, <span class="at">col=</span><span class="cn">FALSE</span>))</span>
<span id="cb842-4"><a href="examples-1.html#cb842-4" aria-hidden="true" tabindex="-1"></a><span class="fu">trellis.par.set</span>(<span class="fu">list</span>(<span class="at">layout.widths=</span><span class="fu">list</span>(<span class="at">left.padding=</span><span class="dv">0</span>, <span class="at">right.padding=</span><span class="dv">0</span>,</span>
<span id="cb842-5"><a href="examples-1.html#cb842-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ylab.axis.padding=</span><span class="dv">0</span>, <span class="at">axis.right=</span><span class="dv">0</span>, <span class="at">key.ylab.padding=</span><span class="dv">0</span>)))</span>
<span id="cb842-6"><a href="examples-1.html#cb842-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb842-7"><a href="examples-1.html#cb842-7" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(<span class="fu">sqrt</span>(Ozone) <span class="sc">~</span> Solar.R<span class="sc">|</span>Temperature<span class="sc">*</span>Wind_Speed,</span>
<span id="cb842-8"><a href="examples-1.html#cb842-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">data=</span>airquality,</span>
<span id="cb842-9"><a href="examples-1.html#cb842-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel=</span><span class="cf">function</span>(x,y,...){</span>
<span id="cb842-10"><a href="examples-1.html#cb842-10" aria-hidden="true" tabindex="-1"></a><span class="co">#            panel.loess(x, y, span=1, degree=1, ...)</span></span>
<span id="cb842-11"><a href="examples-1.html#cb842-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.grid</span>()</span>
<span id="cb842-12"><a href="examples-1.html#cb842-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.lmline</span>(x, y, <span class="at">col=</span><span class="st">&quot;grey&quot;</span>,...)</span>
<span id="cb842-13"><a href="examples-1.html#cb842-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.xyplot</span>(x, y, <span class="at">col=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.5</span>, ...)</span>
<span id="cb842-14"><a href="examples-1.html#cb842-14" aria-hidden="true" tabindex="-1"></a>       },</span>
<span id="cb842-15"><a href="examples-1.html#cb842-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">aspect=</span><span class="dv">1</span>,</span>
<span id="cb842-16"><a href="examples-1.html#cb842-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab=</span><span class="fu">list</span>(<span class="at">label=</span><span class="st">&quot;Sqrt Ozone&quot;</span>, <span class="at">cex=</span><span class="fl">0.6</span>),</span>
<span id="cb842-17"><a href="examples-1.html#cb842-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="fu">list</span>(<span class="at">label=</span><span class="st">&quot;Temperature&quot;</span>, <span class="at">cex=</span><span class="fl">0.6</span>),</span>
<span id="cb842-18"><a href="examples-1.html#cb842-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">scales=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>))),</span>
<span id="cb842-19"><a href="examples-1.html#cb842-19" aria-hidden="true" tabindex="-1"></a><span class="co">#       between=list(y=1),</span></span>
<span id="cb842-20"><a href="examples-1.html#cb842-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">par.strip.text=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">0.4</span>), </span>
<span id="cb842-21"><a href="examples-1.html#cb842-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">par.settings=</span><span class="fu">list</span>(<span class="at">axis.text=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">0.4</span>))</span>
<span id="cb842-22"><a href="examples-1.html#cb842-22" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="lattice_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="examples-1.html#cb843-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(<span class="fu">sqrt</span>(Ozone) <span class="sc">~</span> Wind<span class="sc">|</span>Solar_R<span class="sc">*</span>Temperature,</span>
<span id="cb843-2"><a href="examples-1.html#cb843-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>airquality,</span>
<span id="cb843-3"><a href="examples-1.html#cb843-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">panel=</span><span class="cf">function</span>(x,y,...){</span>
<span id="cb843-4"><a href="examples-1.html#cb843-4" aria-hidden="true" tabindex="-1"></a><span class="co">#            panel.loess(x, y, span=1, degree=1, ...)</span></span>
<span id="cb843-5"><a href="examples-1.html#cb843-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">panel.grid</span>()</span>
<span id="cb843-6"><a href="examples-1.html#cb843-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">panel.lmline</span>(x, y, <span class="at">col=</span><span class="st">&quot;grey&quot;</span>,...)</span>
<span id="cb843-7"><a href="examples-1.html#cb843-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">panel.xyplot</span>(x, y, <span class="at">col=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.5</span>, ...)</span>
<span id="cb843-8"><a href="examples-1.html#cb843-8" aria-hidden="true" tabindex="-1"></a>             },</span>
<span id="cb843-9"><a href="examples-1.html#cb843-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">aspect=</span><span class="dv">1</span>,</span>
<span id="cb843-10"><a href="examples-1.html#cb843-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylab=</span><span class="fu">list</span>(<span class="at">label=</span><span class="st">&quot;Sqrt Ozone&quot;</span>, <span class="at">cex=</span><span class="fl">0.6</span>),</span>
<span id="cb843-11"><a href="examples-1.html#cb843-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab=</span><span class="fu">list</span>(<span class="at">label=</span><span class="st">&quot;Wind Speed&quot;</span>, <span class="at">cex=</span><span class="fl">0.6</span>),</span>
<span id="cb843-12"><a href="examples-1.html#cb843-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>))),</span>
<span id="cb843-13"><a href="examples-1.html#cb843-13" aria-hidden="true" tabindex="-1"></a>                                        <span class="co">#       between=list(y=1),</span></span>
<span id="cb843-14"><a href="examples-1.html#cb843-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">par.strip.text=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">0.4</span>),</span>
<span id="cb843-15"><a href="examples-1.html#cb843-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">par.settings=</span><span class="fu">list</span>(<span class="at">axis.text=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">0.4</span>)))</span></code></pre></div>
<p><img src="lattice_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb844-1"><a href="examples-1.html#cb844-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(<span class="fu">sqrt</span>(Ozone) <span class="sc">~</span> Temp<span class="sc">|</span>Wind_Speed<span class="sc">*</span>Solar_R,</span>
<span id="cb844-2"><a href="examples-1.html#cb844-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">data=</span>airquality,</span>
<span id="cb844-3"><a href="examples-1.html#cb844-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel=</span><span class="cf">function</span>(x,y,...){</span>
<span id="cb844-4"><a href="examples-1.html#cb844-4" aria-hidden="true" tabindex="-1"></a><span class="co">#            panel.loess(x, y, span=1, degree=1, ...)</span></span>
<span id="cb844-5"><a href="examples-1.html#cb844-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.grid</span>()</span>
<span id="cb844-6"><a href="examples-1.html#cb844-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.lmline</span>(x, y, <span class="at">col=</span><span class="st">&quot;grey&quot;</span>,...)</span>
<span id="cb844-7"><a href="examples-1.html#cb844-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.xyplot</span>(x, y, <span class="at">col=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.5</span>, ...)</span>
<span id="cb844-8"><a href="examples-1.html#cb844-8" aria-hidden="true" tabindex="-1"></a>       },</span>
<span id="cb844-9"><a href="examples-1.html#cb844-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">aspect=</span><span class="dv">1</span>,</span>
<span id="cb844-10"><a href="examples-1.html#cb844-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab=</span><span class="fu">list</span>(<span class="at">label=</span><span class="st">&quot;Sqrt Ozone&quot;</span>, <span class="at">cex=</span><span class="fl">0.6</span>),</span>
<span id="cb844-11"><a href="examples-1.html#cb844-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="fu">list</span>(<span class="at">label=</span><span class="st">&quot;Temperature&quot;</span>, <span class="at">cex=</span><span class="fl">0.6</span>),</span>
<span id="cb844-12"><a href="examples-1.html#cb844-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">scales=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="at">alternating=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>))),</span>
<span id="cb844-13"><a href="examples-1.html#cb844-13" aria-hidden="true" tabindex="-1"></a><span class="co">#       between=list(y=1),</span></span>
<span id="cb844-14"><a href="examples-1.html#cb844-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">par.strip.text=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">0.4</span>),</span>
<span id="cb844-15"><a href="examples-1.html#cb844-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">par.settings=</span><span class="fu">list</span>(<span class="at">axis.text=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">0.4</span>)))</span></code></pre></div>
<p><img src="lattice_files/figure-html/unnamed-chunk-11-3.png" width="672" />
# An Overview of the Lattice Package</p>
<ul>
<li>Panel – rectangular drawing area (one or multiple panels),</li>
<li>Data are divided into packet(s) and assigned to each panel, and</li>
<li>Panel function – the function that does the plotting.</li>
</ul>
</div>
<div id="using-lattice-package-1" class="section level2" number="36.3">
<h2><span class="header-section-number">36.3</span> Using Lattice Package</h2>
<ol style="list-style-type: decimal">
<li>Call a high-level lattice plotting function,</li>
<li>The lattice function produces a plotting object,</li>
<li>Call the <code>print.lattice</code> or <code>plot.lattice</code> function to produce the plot.</li>
</ol>
<p>All lattice plotting functions use a formula to specify the plot. The simplest formula <code>y~x</code> specifies the y- and x-axis variables. For example:</p>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="examples-1.html#cb845-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">y=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">z=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>), <span class="dv">5</span>))</span>
<span id="cb845-2"><a href="examples-1.html#cb845-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code></pre></div>
<pre><code>##   x y z
## 1 0 1 a
## 2 1 2 b
## 3 2 3 a
## 4 3 4 b
## 5 4 5 a
## 6 5 6 b</code></pre>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="examples-1.html#cb847-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(y<span class="sc">~</span>x, <span class="at">data=</span>d)</span></code></pre></div>
<p><img src="lattice_files/figure-html/unnamed-chunk-12-1.png" width="672" />
The first argument is the formula and argument <code>data=d</code> specifies the data frame containing the plotting data. The resulting plot is very similar to the plot produced by the traditional plotting function <code>plot</code>. The advantage of lattice plotting functions lies in their capability of using a conditional variable (e.g., month in the PM2.5 example). A conditional variable is to divide the data into packets. In the simple data we just created, we can use variable <code>z</code> as a conditional variable.</p>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="examples-1.html#cb848-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(y<span class="sc">~</span>x<span class="sc">|</span>z, <span class="at">data=</span>d)</span></code></pre></div>
<p><img src="lattice_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="examples-1.html#cb849-1" aria-hidden="true" tabindex="-1"></a><span class="do">## or</span></span>
<span id="cb849-2"><a href="examples-1.html#cb849-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(y<span class="sc">~</span>x, <span class="at">group=</span>z, <span class="at">data=</span>d)</span></code></pre></div>
<p><img src="lattice_files/figure-html/unnamed-chunk-13-2.png" width="672" />
When a conditional variable is specified, the data are split into packets. In this case, the variable <code>z</code> has two unique values, so we have two packets of data. Using the conditioning operator <code>|</code> in the formula, <code>xyplot</code> will create two panels of plots. Using <code>group</code>, the two packets of data will be plotted in the same panel with different plotting symbols or colors.</p>
</div>
<div id="using-lattice-functions-1" class="section level2" number="36.4">
<h2><span class="header-section-number">36.4</span> Using Lattice Functions</h2>
<p>A list of commonly used lattice functions:
-<code>xyplot</code> – scatter plots
-<code>dotplot</code> – Cleveland dot plots
-<code>histogram</code> – histograms
-<code>barchart</code> – bar and column charts
-<code>splom</code> – scatter plot matrix
-<code>levelplot</code> – image plots
-<code>contourplot</code> – contour
-<code>qq</code> – quantile-quantile plots
-<code>qqmath</code> – quantile-quantile plots, comparing data distribution to a standard probability distribution
-<code>cloud</code> – perspective (3-D) plots</p>
</div>
<div id="costom-panel-functions" class="section level2" number="36.5">
<h2><span class="header-section-number">36.5</span> Costom Panel Functions</h2>
<p>The panel function allows customizing a plot, such as superimposing points, lines, text, and other objects. For example, to add a diagonal line to the two panel xyplot, we use:</p>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="examples-1.html#cb850-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(y<span class="sc">~</span>x<span class="sc">|</span>z, <span class="at">data=</span>d,</span>
<span id="cb850-2"><a href="examples-1.html#cb850-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel=</span><span class="cf">function</span>(x, y, ...){</span>
<span id="cb850-3"><a href="examples-1.html#cb850-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">panel.abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb850-4"><a href="examples-1.html#cb850-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">panel.xyplot</span>(x, y, ...)</span>
<span id="cb850-5"><a href="examples-1.html#cb850-5" aria-hidden="true" tabindex="-1"></a>       })</span></code></pre></div>
<p><img src="lattice_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>As an example, let’s take a look of the <a href="https://www.nber.org/data/vital-statistics-natality-data.html">2015 data of births in the US</a>. It is a .csv file of about 3Gb. I read it into my desktop (MacPro with 32Gb of RAM) and simplified the data.</p>
<pre><code>## natality2015 &lt;- read.csv(paste(dataDIR, &quot;natl2015.csv&quot;, sep=&quot;/&quot;))
## natlABB2015 &lt;- natality2015[,c(&quot;dob_mm&quot;,&quot;dob_tt&quot;, &quot;dob_wk&quot;, &quot;dmeth_rec&quot;,&quot;mager9&quot;)]
## save(natlABB2015, file=&quot;abbnatality2015.RData&quot;)
load(paste(base, &quot;abbnatality2015.RData&quot;, sep=&quot;/&quot;))</code></pre>
<p>Let’s use histogram or barchart to see the frequency distribution of births over a typical week in 2015.</p>
<pre><code>birth.dow &lt;- table(natlABB2015$dob_wk)
barchart(birth.dow)
histogram(~dob_wk, data=natlABB2015)</code></pre>
<p>One interesting question is about the birth distribution over a week: why there are fewer births over the weekend?</p>
<pre><code>dob.dm.tbl &lt;- table(wk=natlABB2015$dob_wk, mm=natlABB2015$dmeth_rec)
barchart(dob.dm.tbl)
barchart(dob.dm.tbl, stack=F)
barchart(dob.dm.tbl, stack=F, horizontal = F)
barchart(dob.dm.tbl, horizontal = F, group=F)</code></pre>
<p>The same can be shown using histogram:</p>
<pre><code>natlABB2015$dmeth_rec[natlABB2015$dmeth_rec==9] &lt;- NA
histogram(~dob_wk|dmeth_rec, data=natlABB2015)
histogram(~dob_wk|factor(dmeth_rec), data=natlABB2015)

natlABB2015$dmeth_rec&lt;- as.character(natlABB2015$dmeth_rec)
natlABB2015$dmeth_rec[natlABB2015$dmeth_rec==&quot;1&quot;] &lt;- &quot;V&quot;
natlABB2015$dmeth_rec[natlABB2015$dmeth_rec==&quot;2&quot;] &lt;- &quot;C&quot;</code></pre>
<p>Why the number of births is lower over the weekend?</p>
<p>Are there monthly patterns?</p>
<pre><code>dob.mm.wk &lt;- table(week=natlABB2015$dob_wk, month=natlABB2015$dob_mm, method=natlABB2015$dmeth_rec)
dotplot(dob.mm.wk)
dotplot(dob.mm.wk, auto.key=T)</code></pre>
<p>Again, why low number of births in weekends?</p>
<pre><code>dob.age.wk &lt;- table(week=natlABB2015$dob_wk, age=natlABB2015$mager9, method=natlABB2015$dmeth_rec)
dotplot(dob.age.wk, auto.key=T)
dotplot(log(dob.age.wk), auto.key=T)</code></pre>
</div>
<div id="the-example-that-started-trellis-1" class="section level2" number="36.6">
<h2><span class="header-section-number">36.6</span> The Example That Started Trellis</h2>
<p>The <code>barley</code> dataset –
&gt; These data are yields in bushels per acre, of 10 varieties of barley grown in 1/40 acre plots at University Farm, St. Paul, and at the five branch experiment stations located at Waseca, Morris, Crookston, Grand Rapids, and Duluth (all in Minnesota). The varieties were grown in three randomized blocks at each of the six stations during 1931 and 1932, different land being used each year of the test.</p>
<blockquote>
<p>Immer et al. (1934) present the data for each Year<em>Site</em>Variety*Block. The data here is the average yield across the three blocks.</p>
</blockquote>
<blockquote>
<p>Immer et al. (1934) refer (once) to the experiment as being conducted in 1930 and 1931, then later refer to it (repeatedly) as being conducted in 1931 and 1932. Later authors have continued the confusion.</p>
</blockquote>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="examples-1.html#cb857-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(barley)</span></code></pre></div>
<pre><code>## [1] 120   4</code></pre>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="examples-1.html#cb859-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(barley)</span></code></pre></div>
<pre><code>##      yield   variety year            site
## 1 27.00000 Manchuria 1931 University Farm
## 2 48.86667 Manchuria 1931          Waseca
## 3 27.43334 Manchuria 1931          Morris
## 4 39.93333 Manchuria 1931       Crookston
## 5 32.96667 Manchuria 1931    Grand Rapids
## 6 28.96667 Manchuria 1931          Duluth</code></pre>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="examples-1.html#cb861-1" aria-hidden="true" tabindex="-1"></a>     <span class="fu">dotplot</span>(variety <span class="sc">~</span> yield <span class="sc">|</span> site, <span class="at">data =</span> barley)</span></code></pre></div>
<p><img src="lattice_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="examples-1.html#cb862-1" aria-hidden="true" tabindex="-1"></a>     <span class="fu">dotplot</span>(variety <span class="sc">~</span> yield <span class="sc">|</span> site, <span class="at">data =</span> barley, <span class="at">groups=</span>year)     </span></code></pre></div>
<p><img src="lattice_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="examples-1.html#cb863-1" aria-hidden="true" tabindex="-1"></a>     <span class="fu">dotplot</span>(variety <span class="sc">~</span> yield <span class="sc">|</span> site, <span class="at">data =</span> barley, <span class="at">groups=</span>year, </span>
<span id="cb863-2"><a href="examples-1.html#cb863-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">aspect=</span><span class="fl">0.5</span>, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>))</span></code></pre></div>
<p><img src="lattice_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="examples-1.html#cb864-1" aria-hidden="true" tabindex="-1"></a>     key <span class="ot">&lt;-</span> <span class="fu">simpleKey</span>(<span class="fu">levels</span>(barley<span class="sc">$</span>year), <span class="at">space =</span> <span class="st">&quot;right&quot;</span>)</span>
<span id="cb864-2"><a href="examples-1.html#cb864-2" aria-hidden="true" tabindex="-1"></a>     key<span class="sc">$</span>text<span class="sc">$</span>cex <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb864-3"><a href="examples-1.html#cb864-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">dotplot</span>(variety <span class="sc">~</span> yield <span class="sc">|</span> site, <span class="at">data =</span> barley, <span class="at">groups =</span> year,</span>
<span id="cb864-4"><a href="examples-1.html#cb864-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">key =</span> key,</span>
<span id="cb864-5"><a href="examples-1.html#cb864-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab =</span> <span class="st">&quot;Barley Yield (bushels/acre) &quot;</span>,</span>
<span id="cb864-6"><a href="examples-1.html#cb864-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">aspect=</span><span class="fl">0.5</span>, <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>), <span class="at">ylab=</span><span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="lattice_files/figure-html/unnamed-chunk-15-4.png" width="672" /></p>
<p>Now we want to save it into a PDF file:</p>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="examples-1.html#cb865-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="at">file=</span><span class="fu">paste</span>(dataDIR, <span class="st">&quot;barley.pdf&quot;</span>, <span class="at">sep=</span><span class="st">&quot;/&quot;</span>), <span class="at">height=</span><span class="dv">8</span>, <span class="at">width=</span><span class="dv">5</span>)</span>
<span id="cb865-2"><a href="examples-1.html#cb865-2" aria-hidden="true" tabindex="-1"></a><span class="fu">trellis.par.set</span>(<span class="at">theme =</span> <span class="fu">canonical.theme</span>(<span class="st">&quot;postscript&quot;</span>, <span class="at">col=</span><span class="cn">FALSE</span>))</span>
<span id="cb865-3"><a href="examples-1.html#cb865-3" aria-hidden="true" tabindex="-1"></a><span class="fu">trellis.par.set</span>(<span class="fu">list</span>(<span class="at">fontsize=</span><span class="fu">list</span>(<span class="at">text=</span><span class="dv">6</span>),</span>
<span id="cb865-4"><a href="examples-1.html#cb865-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">par.xlab.text=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">1.5</span>),</span>
<span id="cb865-5"><a href="examples-1.html#cb865-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">add.text=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">1.5</span>),</span>
<span id="cb865-6"><a href="examples-1.html#cb865-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">superpose.symbol=</span><span class="fu">list</span>(<span class="at">cex=</span>.<span class="dv">5</span>)))</span>
<span id="cb865-7"><a href="examples-1.html#cb865-7" aria-hidden="true" tabindex="-1"></a>     key <span class="ot">&lt;-</span> <span class="fu">simpleKey</span>(<span class="fu">levels</span>(barley<span class="sc">$</span>year), <span class="at">space =</span> <span class="st">&quot;right&quot;</span>)</span>
<span id="cb865-8"><a href="examples-1.html#cb865-8" aria-hidden="true" tabindex="-1"></a>     key<span class="sc">$</span>text<span class="sc">$</span>cex <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb865-9"><a href="examples-1.html#cb865-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">dotplot</span>(variety <span class="sc">~</span> yield <span class="sc">|</span> site, <span class="at">data =</span> barley, <span class="at">groups =</span> year,</span>
<span id="cb865-10"><a href="examples-1.html#cb865-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">key =</span> key,</span>
<span id="cb865-11"><a href="examples-1.html#cb865-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab =</span> <span class="st">&quot;Barley Yield (bushels/acre) &quot;</span>,</span>
<span id="cb865-12"><a href="examples-1.html#cb865-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">aspect=</span><span class="fl">0.5</span>, <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>), <span class="at">ylab=</span><span class="cn">NULL</span>)</span>
<span id="cb865-13"><a href="examples-1.html#cb865-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
</div>
<div id="an-example-of-graphical-exploratory-data-analysis-1" class="section level2" number="36.7">
<h2><span class="header-section-number">36.7</span> An Example of Graphical Exploratory Data Analysis</h2>
<p>The foodweb for the animal species in an ecosystem is a description of
who eats whom. A chain is a path through the web. It begins with a
species that is eaten by no other, moves to a species that the first
species eats, moves next to a species that the second species eats,
and so forth until the chain ends at a species that preys on no
other. If there are 7 species in the chain then there are 6 links
between species, and the length of the chain is 6. The mean chain
length of a web is the mean of the lengths of all chains in the web.</p>
<p>Ecosystems can be categorized based on their spatial dimensions: two-,
three-, or mixed-dimensional ecosystems. The following plots analyze
the mean chain length data from 113 ecosystems.</p>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="examples-1.html#cb867-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb867-2"><a href="examples-1.html#cb867-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb867-3"><a href="examples-1.html#cb867-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)  <span class="co"># using this library for date object</span></span>
<span id="cb867-4"><a href="examples-1.html#cb867-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data.restore</span> (<span class="fu">paste</span>(dataDIR, <span class="st">&quot;visualizing.data&quot;</span>, <span class="at">sep=</span><span class="st">&quot;/&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;/Users/Whitney/Desktop/Documents/UT Fall 2021/Env. Data Management/R/Bookdown/Data/visualizing.data&quot;</code></pre>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb869-1"><a href="examples-1.html#cb869-1" aria-hidden="true" tabindex="-1"></a><span class="do">## quantile plot</span></span>
<span id="cb869-2"><a href="examples-1.html#cb869-2" aria-hidden="true" tabindex="-1"></a>book.<span class="fl">2.34</span> <span class="ot">&lt;-</span></span>
<span id="cb869-3"><a href="examples-1.html#cb869-3" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>()</span>
<span id="cb869-4"><a href="examples-1.html#cb869-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">qqmath</span>(<span class="sc">~</span> mean.length <span class="sc">|</span> dimension,</span>
<span id="cb869-5"><a href="examples-1.html#cb869-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">distribution =</span> qunif,</span>
<span id="cb869-6"><a href="examples-1.html#cb869-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>food.web,</span>
<span id="cb869-7"><a href="examples-1.html#cb869-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel =</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb869-8"><a href="examples-1.html#cb869-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.grid</span>()</span>
<span id="cb869-9"><a href="examples-1.html#cb869-9" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">panel.qqmath</span>(x, ...)</span>
<span id="cb869-10"><a href="examples-1.html#cb869-10" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb869-11"><a href="examples-1.html#cb869-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),</span>
<span id="cb869-12"><a href="examples-1.html#cb869-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect=</span><span class="dv">1</span>,</span>
<span id="cb869-13"><a href="examples-1.html#cb869-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">sub =</span> <span class="fu">list</span>(<span class="st">&quot;Figure 2.34&quot;</span>,<span class="at">cex=</span>.<span class="dv">8</span>),</span>
<span id="cb869-14"><a href="examples-1.html#cb869-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;f-value&quot;</span>,</span>
<span id="cb869-15"><a href="examples-1.html#cb869-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Chain Length&quot;</span>)</span>
<span id="cb869-16"><a href="examples-1.html#cb869-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb869-17"><a href="examples-1.html#cb869-17" aria-hidden="true" tabindex="-1"></a>book.<span class="fl">2.35</span> <span class="ot">&lt;-</span></span>
<span id="cb869-18"><a href="examples-1.html#cb869-18" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>()</span>
<span id="cb869-19"><a href="examples-1.html#cb869-19" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb869-20"><a href="examples-1.html#cb869-20" aria-hidden="true" tabindex="-1"></a>    foo.m <span class="ot">&lt;-</span> <span class="fu">oneway</span>(mean.length<span class="sc">~</span>dimension, <span class="at">data =</span> food.web, <span class="at">location =</span> median, <span class="at">spread=</span><span class="dv">1</span>)</span>
<span id="cb869-21"><a href="examples-1.html#cb869-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">19</span>)</span>
<span id="cb869-22"><a href="examples-1.html#cb869-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xyplot</span>(<span class="fu">sqrt</span>(<span class="fu">abs</span>(<span class="fu">residuals</span>(foo.m))) <span class="sc">~</span> <span class="fu">jitter</span>(<span class="fu">fitted.values</span>(foo.m),<span class="at">factor=</span><span class="fl">0.3</span>),</span>
<span id="cb869-23"><a href="examples-1.html#cb869-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect=</span><span class="dv">1</span>,</span>
<span id="cb869-24"><a href="examples-1.html#cb869-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel =</span> <span class="fu">substitute</span>(<span class="cf">function</span>(x,y){</span>
<span id="cb869-25"><a href="examples-1.html#cb869-25" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.xyplot</span>(x,y)</span>
<span id="cb869-26"><a href="examples-1.html#cb869-26" aria-hidden="true" tabindex="-1"></a>            srmads <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="fu">abs</span>(<span class="fu">residuals</span>(foo.m)),</span>
<span id="cb869-27"><a href="examples-1.html#cb869-27" aria-hidden="true" tabindex="-1"></a>                food.web<span class="sc">$</span>dimension, median)</span>
<span id="cb869-28"><a href="examples-1.html#cb869-28" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.lines</span>(foo.m<span class="sc">$</span>location,srmads)</span>
<span id="cb869-29"><a href="examples-1.html#cb869-29" aria-hidden="true" tabindex="-1"></a>        }),</span>
<span id="cb869-30"><a href="examples-1.html#cb869-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">sub =</span> <span class="fu">list</span>(<span class="st">&quot;Figure 2.35&quot;</span>,<span class="at">cex=</span>.<span class="dv">8</span>),</span>
<span id="cb869-31"><a href="examples-1.html#cb869-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;Jittered Median Chain Length&quot;</span>,</span>
<span id="cb869-32"><a href="examples-1.html#cb869-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Square Root Absolute Residual Chain Length&quot;</span>)</span>
<span id="cb869-33"><a href="examples-1.html#cb869-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb869-34"><a href="examples-1.html#cb869-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb869-35"><a href="examples-1.html#cb869-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb869-36"><a href="examples-1.html#cb869-36" aria-hidden="true" tabindex="-1"></a>book.<span class="fl">2.36</span> <span class="ot">&lt;-</span></span>
<span id="cb869-37"><a href="examples-1.html#cb869-37" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>()</span>
<span id="cb869-38"><a href="examples-1.html#cb869-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">qqmath</span>(<span class="sc">~</span> mean.length <span class="sc">|</span> dimension,</span>
<span id="cb869-39"><a href="examples-1.html#cb869-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>food.web,</span>
<span id="cb869-40"><a href="examples-1.html#cb869-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">prepanel =</span> prepanel.qqmathline,</span>
<span id="cb869-41"><a href="examples-1.html#cb869-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel =</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb869-42"><a href="examples-1.html#cb869-42" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.grid</span>()</span>
<span id="cb869-43"><a href="examples-1.html#cb869-43" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">panel.qqmathline</span>(x, <span class="at">distribution =</span> qnorm)</span>
<span id="cb869-44"><a href="examples-1.html#cb869-44" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">panel.qqmath</span>(x, ...)</span>
<span id="cb869-45"><a href="examples-1.html#cb869-45" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb869-46"><a href="examples-1.html#cb869-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),</span>
<span id="cb869-47"><a href="examples-1.html#cb869-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect=</span><span class="dv">1</span>, </span>
<span id="cb869-48"><a href="examples-1.html#cb869-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">sub =</span> <span class="fu">list</span>(<span class="st">&quot;Figure 2.36&quot;</span>,<span class="at">cex=</span>.<span class="dv">8</span>),</span>
<span id="cb869-49"><a href="examples-1.html#cb869-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Unit Normal Quantile&quot;</span>,</span>
<span id="cb869-50"><a href="examples-1.html#cb869-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Chain Length&quot;</span>)</span>
<span id="cb869-51"><a href="examples-1.html#cb869-51" aria-hidden="true" tabindex="-1"></a>book.<span class="fl">2.37</span> <span class="ot">&lt;-</span></span>
<span id="cb869-52"><a href="examples-1.html#cb869-52" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>()</span>
<span id="cb869-53"><a href="examples-1.html#cb869-53" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb869-54"><a href="examples-1.html#cb869-54" aria-hidden="true" tabindex="-1"></a>    foo.m <span class="ot">&lt;-</span> <span class="fu">oneway</span>(<span class="fu">log</span>(mean.length, <span class="dv">2</span>) <span class="sc">~</span> dimension, <span class="at">data =</span> food.web, <span class="at">location =</span> median, <span class="at">spread =</span> <span class="dv">1</span>)</span>
<span id="cb869-55"><a href="examples-1.html#cb869-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">19</span>)</span>
<span id="cb869-56"><a href="examples-1.html#cb869-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xyplot</span>(<span class="fu">sqrt</span>(<span class="fu">abs</span>(<span class="fu">residuals</span>(foo.m))) <span class="sc">~</span> <span class="fu">jitter</span>(<span class="fu">fitted.values</span>(foo.m), <span class="at">factor =</span> <span class="fl">0.3</span>),</span>
<span id="cb869-57"><a href="examples-1.html#cb869-57" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel =</span> <span class="fu">substitute</span>(<span class="cf">function</span>(x, y) {</span>
<span id="cb869-58"><a href="examples-1.html#cb869-58" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.xyplot</span>(x, y)</span>
<span id="cb869-59"><a href="examples-1.html#cb869-59" aria-hidden="true" tabindex="-1"></a>            add.line <span class="ot">&lt;-</span> <span class="fu">trellis.par.get</span>(<span class="st">&quot;add.line&quot;</span>)</span>
<span id="cb869-60"><a href="examples-1.html#cb869-60" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.lines</span>(foo.m<span class="sc">$</span>location, <span class="fu">tapply</span>(y, food.web<span class="sc">$</span>dimension, median), </span>
<span id="cb869-61"><a href="examples-1.html#cb869-61" aria-hidden="true" tabindex="-1"></a>                <span class="at">lty =</span> add.line<span class="sc">$</span>lty, <span class="at">lwd =</span> add.line<span class="sc">$</span>lwd, <span class="at">col =</span> add.line<span class="sc">$</span>col)</span>
<span id="cb869-62"><a href="examples-1.html#cb869-62" aria-hidden="true" tabindex="-1"></a>        }),</span>
<span id="cb869-63"><a href="examples-1.html#cb869-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect =</span> <span class="dv">1</span>,</span>
<span id="cb869-64"><a href="examples-1.html#cb869-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">sub =</span> <span class="fu">list</span>(<span class="st">&quot;Figure 2.37&quot;</span>,<span class="at">cex=</span>.<span class="dv">8</span>),</span>
<span id="cb869-65"><a href="examples-1.html#cb869-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Jittered Median Log 2 Chain Length&quot;</span>,</span>
<span id="cb869-66"><a href="examples-1.html#cb869-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Square Root Absolute Residual Log 2 Chain Length&quot;</span>)</span>
<span id="cb869-67"><a href="examples-1.html#cb869-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb869-68"><a href="examples-1.html#cb869-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb869-69"><a href="examples-1.html#cb869-69" aria-hidden="true" tabindex="-1"></a>book.<span class="fl">2.38</span> <span class="ot">&lt;-</span></span>
<span id="cb869-70"><a href="examples-1.html#cb869-70" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>()</span>
<span id="cb869-71"><a href="examples-1.html#cb869-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">qqmath</span>(<span class="sc">~</span> <span class="fu">log</span>(mean.length,<span class="dv">2</span>) <span class="sc">|</span> dimension,</span>
<span id="cb869-72"><a href="examples-1.html#cb869-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>food.web,</span>
<span id="cb869-73"><a href="examples-1.html#cb869-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">prepanel =</span> prepanel.qqmathline,</span>
<span id="cb869-74"><a href="examples-1.html#cb869-74" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel =</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb869-75"><a href="examples-1.html#cb869-75" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.grid</span>()</span>
<span id="cb869-76"><a href="examples-1.html#cb869-76" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">panel.qqmathline</span>(x, <span class="at">distribution =</span> qnorm)</span>
<span id="cb869-77"><a href="examples-1.html#cb869-77" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">panel.qqmath</span>(x, ...)</span>
<span id="cb869-78"><a href="examples-1.html#cb869-78" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb869-79"><a href="examples-1.html#cb869-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),</span>
<span id="cb869-80"><a href="examples-1.html#cb869-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect=</span><span class="dv">1</span>, </span>
<span id="cb869-81"><a href="examples-1.html#cb869-81" aria-hidden="true" tabindex="-1"></a>        <span class="at">sub =</span> <span class="fu">list</span>(<span class="st">&quot;Figure 2.38&quot;</span>,<span class="at">cex=</span>.<span class="dv">8</span>),</span>
<span id="cb869-82"><a href="examples-1.html#cb869-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Unit Normal Quantile&quot;</span>,</span>
<span id="cb869-83"><a href="examples-1.html#cb869-83" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Log 2 Chain Length&quot;</span>)</span>
<span id="cb869-84"><a href="examples-1.html#cb869-84" aria-hidden="true" tabindex="-1"></a>book.<span class="fl">2.39</span> <span class="ot">&lt;-</span></span>
<span id="cb869-85"><a href="examples-1.html#cb869-85" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>()</span>
<span id="cb869-86"><a href="examples-1.html#cb869-86" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb869-87"><a href="examples-1.html#cb869-87" aria-hidden="true" tabindex="-1"></a>    foo.m <span class="ot">&lt;-</span> <span class="fu">oneway</span>(<span class="dv">1</span><span class="sc">/</span>mean.length <span class="sc">~</span> dimension, <span class="at">data =</span> food.web, <span class="at">location =</span> median, <span class="at">spread =</span> <span class="dv">1</span>)</span>
<span id="cb869-88"><a href="examples-1.html#cb869-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">19</span>)</span>
<span id="cb869-89"><a href="examples-1.html#cb869-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xyplot</span>(<span class="fu">sqrt</span>(<span class="fu">abs</span>(<span class="fu">residuals</span>(foo.m))) <span class="sc">~</span> <span class="fu">jitter</span>(<span class="fu">fitted.values</span>(foo.m), <span class="at">factor =</span> <span class="fl">0.3</span>),</span>
<span id="cb869-90"><a href="examples-1.html#cb869-90" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel =</span> <span class="fu">substitute</span>(<span class="cf">function</span>(x,y) {</span>
<span id="cb869-91"><a href="examples-1.html#cb869-91" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.xyplot</span>(x,y)</span>
<span id="cb869-92"><a href="examples-1.html#cb869-92" aria-hidden="true" tabindex="-1"></a>                    add.line <span class="ot">&lt;-</span> <span class="fu">trellis.par.get</span>(<span class="st">&quot;add.line&quot;</span>)</span>
<span id="cb869-93"><a href="examples-1.html#cb869-93" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.lines</span>(foo.m<span class="sc">$</span>location, <span class="fu">tapply</span>(y, food.web<span class="sc">$</span>dimension, median),</span>
<span id="cb869-94"><a href="examples-1.html#cb869-94" aria-hidden="true" tabindex="-1"></a>            <span class="at">lty =</span> add.line<span class="sc">$</span>lty, <span class="at">lwd =</span> add.line<span class="sc">$</span>lwd, <span class="at">col =</span> add.line<span class="sc">$</span>col)</span>
<span id="cb869-95"><a href="examples-1.html#cb869-95" aria-hidden="true" tabindex="-1"></a>        }),</span>
<span id="cb869-96"><a href="examples-1.html#cb869-96" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect =</span> <span class="dv">1</span>,</span>
<span id="cb869-97"><a href="examples-1.html#cb869-97" aria-hidden="true" tabindex="-1"></a>        <span class="at">sub =</span> <span class="fu">list</span>(<span class="st">&quot;Figure 2.39&quot;</span>,<span class="at">cex=</span>.<span class="dv">8</span>),</span>
<span id="cb869-98"><a href="examples-1.html#cb869-98" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Jittered Median Link Fraction&quot;</span>,</span>
<span id="cb869-99"><a href="examples-1.html#cb869-99" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Square Root Absolute Residual Link Fraction&quot;</span>)</span>
<span id="cb869-100"><a href="examples-1.html#cb869-100" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb869-101"><a href="examples-1.html#cb869-101" aria-hidden="true" tabindex="-1"></a>book.<span class="fl">2.4</span> <span class="ot">&lt;-</span></span>
<span id="cb869-102"><a href="examples-1.html#cb869-102" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>()</span>
<span id="cb869-103"><a href="examples-1.html#cb869-103" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb869-104"><a href="examples-1.html#cb869-104" aria-hidden="true" tabindex="-1"></a>    voice.part <span class="ot">&lt;-</span> <span class="fu">ordered</span>(singer<span class="sc">$</span>voice.part,</span>
<span id="cb869-105"><a href="examples-1.html#cb869-105" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">&quot;Soprano 1&quot;</span>, <span class="st">&quot;Soprano 2&quot;</span>, <span class="st">&quot;Alto 1&quot;</span>, <span class="st">&quot;Alto 2&quot;</span>,</span>
<span id="cb869-106"><a href="examples-1.html#cb869-106" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Tenor 1&quot;</span>, <span class="st">&quot;Tenor 2&quot;</span>, <span class="st">&quot;Bass 1&quot;</span>, <span class="st">&quot;Bass 2&quot;</span>))</span>
<span id="cb869-107"><a href="examples-1.html#cb869-107" aria-hidden="true" tabindex="-1"></a>    bass.tenor.qq <span class="ot">&lt;-</span> <span class="fu">qq</span>(voice.part <span class="sc">~</span> singer<span class="sc">$</span>height,</span>
<span id="cb869-108"><a href="examples-1.html#cb869-108" aria-hidden="true" tabindex="-1"></a>        <span class="at">subset=</span>voice.part<span class="sc">==</span><span class="st">&quot;Bass 2&quot;</span> <span class="sc">|</span> voice.part<span class="sc">==</span><span class="st">&quot;Tenor 1&quot;</span>)</span>
<span id="cb869-109"><a href="examples-1.html#cb869-109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tmd</span>(bass.tenor.qq,</span>
<span id="cb869-110"><a href="examples-1.html#cb869-110" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect=</span><span class="dv">1</span>,</span>
<span id="cb869-111"><a href="examples-1.html#cb869-111" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Difference (inches)&quot;</span>,</span>
<span id="cb869-112"><a href="examples-1.html#cb869-112" aria-hidden="true" tabindex="-1"></a>        <span class="at">sub =</span> <span class="fu">list</span>(<span class="st">&quot;Figure 2.4&quot;</span>,<span class="at">cex=</span>.<span class="dv">8</span>),</span>
<span id="cb869-113"><a href="examples-1.html#cb869-113" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Mean (inches)&quot;</span>)</span>
<span id="cb869-114"><a href="examples-1.html#cb869-114" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb869-115"><a href="examples-1.html#cb869-115" aria-hidden="true" tabindex="-1"></a>book.<span class="fl">2.40</span> <span class="ot">&lt;-</span></span>
<span id="cb869-116"><a href="examples-1.html#cb869-116" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>()</span>
<span id="cb869-117"><a href="examples-1.html#cb869-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">qqmath</span>(<span class="sc">~</span> (<span class="dv">1</span><span class="sc">/</span>mean.length) <span class="sc">|</span> dimension,</span>
<span id="cb869-118"><a href="examples-1.html#cb869-118" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> food.web,</span>
<span id="cb869-119"><a href="examples-1.html#cb869-119" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel =</span> <span class="cf">function</span>(x, ...){</span>
<span id="cb869-120"><a href="examples-1.html#cb869-120" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.grid</span>()</span>
<span id="cb869-121"><a href="examples-1.html#cb869-121" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.qqmath</span>(x, ...)</span>
<span id="cb869-122"><a href="examples-1.html#cb869-122" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.qqmathline</span>(x, <span class="at">distribution =</span> qnorm)</span>
<span id="cb869-123"><a href="examples-1.html#cb869-123" aria-hidden="true" tabindex="-1"></a>           },</span>
<span id="cb869-124"><a href="examples-1.html#cb869-124" aria-hidden="true" tabindex="-1"></a>           <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb869-125"><a href="examples-1.html#cb869-125" aria-hidden="true" tabindex="-1"></a>           <span class="at">aspect =</span> <span class="dv">1</span>,</span>
<span id="cb869-126"><a href="examples-1.html#cb869-126" aria-hidden="true" tabindex="-1"></a>        <span class="at">sub =</span> <span class="fu">list</span>(<span class="st">&quot;Figure 2.40&quot;</span>,<span class="at">cex=</span>.<span class="dv">8</span>),</span>
<span id="cb869-127"><a href="examples-1.html#cb869-127" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">&quot;Unit Normal Quantile&quot;</span>, </span>
<span id="cb869-128"><a href="examples-1.html#cb869-128" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylab =</span> <span class="st">&quot;Link Fraction&quot;</span>)</span>
<span id="cb869-129"><a href="examples-1.html#cb869-129" aria-hidden="true" tabindex="-1"></a>book.<span class="fl">2.41</span> <span class="ot">&lt;-</span></span>
<span id="cb869-130"><a href="examples-1.html#cb869-130" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>()</span>
<span id="cb869-131"><a href="examples-1.html#cb869-131" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb869-132"><a href="examples-1.html#cb869-132" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">oneway</span>((<span class="dv">1</span><span class="sc">/</span>mean.length)<span class="sc">~</span>dimension, <span class="at">data =</span> food.web, <span class="at">spread =</span> <span class="dv">1</span>)<span class="sc">$</span>residuals</span>
<span id="cb869-133"><a href="examples-1.html#cb869-133" aria-hidden="true" tabindex="-1"></a>    <span class="fu">qqmath</span>(<span class="sc">~</span> res <span class="sc">|</span> food.web<span class="sc">$</span>dimension,</span>
<span id="cb869-134"><a href="examples-1.html#cb869-134" aria-hidden="true" tabindex="-1"></a>        <span class="at">distribution =</span> <span class="fu">substitute</span>(<span class="cf">function</span>(p) <span class="fu">quantile</span>(res, p)),</span>
<span id="cb869-135"><a href="examples-1.html#cb869-135" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel=</span><span class="cf">function</span>(x,...){</span>
<span id="cb869-136"><a href="examples-1.html#cb869-136" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.grid</span>()</span>
<span id="cb869-137"><a href="examples-1.html#cb869-137" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb869-138"><a href="examples-1.html#cb869-138" aria-hidden="true" tabindex="-1"></a>            <span class="fu">panel.qqmath</span>(x, ...)</span>
<span id="cb869-139"><a href="examples-1.html#cb869-139" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb869-140"><a href="examples-1.html#cb869-140" aria-hidden="true" tabindex="-1"></a>        <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),</span>
<span id="cb869-141"><a href="examples-1.html#cb869-141" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect=</span><span class="dv">1</span>,</span>
<span id="cb869-142"><a href="examples-1.html#cb869-142" aria-hidden="true" tabindex="-1"></a>        <span class="at">sub =</span> <span class="fu">list</span>(<span class="st">&quot;Figure 2.41&quot;</span>,<span class="at">cex=</span>.<span class="dv">8</span>),</span>
<span id="cb869-143"><a href="examples-1.html#cb869-143" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Pooled Residual Link Fraction&quot;</span>,</span>
<span id="cb869-144"><a href="examples-1.html#cb869-144" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Residual Link Fraction&quot;</span>)</span>
<span id="cb869-145"><a href="examples-1.html#cb869-145" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb869-146"><a href="examples-1.html#cb869-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb869-147"><a href="examples-1.html#cb869-147" aria-hidden="true" tabindex="-1"></a>book.<span class="fl">2.42</span> <span class="ot">&lt;-</span></span>
<span id="cb869-148"><a href="examples-1.html#cb869-148" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>()</span>
<span id="cb869-149"><a href="examples-1.html#cb869-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rfs</span>(<span class="fu">oneway</span>((<span class="dv">1</span><span class="sc">/</span>mean.length)<span class="sc">~</span>dimension, <span class="at">data =</span> food.web, <span class="at">spread =</span> <span class="dv">1</span>),</span>
<span id="cb869-150"><a href="examples-1.html#cb869-150" aria-hidden="true" tabindex="-1"></a>        <span class="at">sub =</span> <span class="fu">list</span>(<span class="st">&quot;Figure 2.42&quot;</span>,<span class="at">cex=</span>.<span class="dv">8</span>),</span>
<span id="cb869-151"><a href="examples-1.html#cb869-151" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect=</span><span class="dv">1</span>,</span>
<span id="cb869-152"><a href="examples-1.html#cb869-152" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Link Fraction&quot;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-5.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction-6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
