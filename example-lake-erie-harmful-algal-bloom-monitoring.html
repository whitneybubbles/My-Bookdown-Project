<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Example: Lake Erie Harmful Algal Bloom Monitoring | Advanced Environmental Data Management</title>
  <meta name="description" content="9 Example: Lake Erie Harmful Algal Bloom Monitoring | Advanced Environmental Data Management" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Example: Lake Erie Harmful Algal Bloom Monitoring | Advanced Environmental Data Management" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Example: Lake Erie Harmful Algal Bloom Monitoring | Advanced Environmental Data Management" />
  
  
  

<meta name="author" content="Whitney Adam" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="graphical-functions.html"/>
<link rel="next" href="introduction-1.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html"><i class="fa fa-check"></i><b>2</b> Importing Data into R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#typing-vectors-and-matrices"><i class="fa fa-check"></i><b>2.1</b> Typing Vectors and Matrices</a></li>
<li class="chapter" data-level="2.2" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#reading-data-frame"><i class="fa fa-check"></i><b>2.2</b> Reading Data Frame</a></li>
<li class="chapter" data-level="2.3" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#fixed-with-input-files"><i class="fa fa-check"></i><b>2.3</b> Fixed-with Input Files</a></li>
<li class="chapter" data-level="2.4" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#generating-data"><i class="fa fa-check"></i><b>2.4</b> Generating Data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#sequences"><i class="fa fa-check"></i><b>2.4.1</b> Sequences</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#random-number-generators"><i class="fa fa-check"></i><b>2.5</b> Random Number Generators</a></li>
<li class="chapter" data-level="2.6" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#random-permutation"><i class="fa fa-check"></i><b>2.6</b> Random Permutation</a></li>
<li class="chapter" data-level="2.7" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#spreadsheet"><i class="fa fa-check"></i><b>2.7</b> Spreadsheet</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="saving-r-data.html"><a href="saving-r-data.html"><i class="fa fa-check"></i><b>3</b> Saving R Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="saving-r-data.html"><a href="saving-r-data.html#writing-r-objects-to-files-in-ascii-format"><i class="fa fa-check"></i><b>3.1</b> Writing R Objects to Files in ASCII Format</a></li>
<li class="chapter" data-level="3.2" data-path="saving-r-data.html"><a href="saving-r-data.html#reading-data-from-other-programs"><i class="fa fa-check"></i><b>3.2</b> Reading Data from Other Programs</a></li>
<li class="chapter" data-level="3.3" data-path="saving-r-data.html"><a href="saving-r-data.html#functions-in-foreign-package"><i class="fa fa-check"></i><b>3.3</b> Functions in <code>foreign</code> package</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="date-objects.html"><a href="date-objects.html"><i class="fa fa-check"></i><b>4</b> Date Objects</a>
<ul>
<li class="chapter" data-level="4.1" data-path="date-objects.html"><a href="date-objects.html#date-formats-in-r-date-time-classes"><i class="fa fa-check"></i><b>4.1</b> Date formats in R date-time classes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>5</b> Summary Statistics</a></li>
<li class="chapter" data-level="6" data-path="anatomy-of-a-plot.html"><a href="anatomy-of-a-plot.html"><i class="fa fa-check"></i><b>6</b> Anatomy of a Plot</a></li>
<li class="chapter" data-level="7" data-path="customizing-a-plot.html"><a href="customizing-a-plot.html"><i class="fa fa-check"></i><b>7</b> Customizing a Plot</a></li>
<li class="chapter" data-level="8" data-path="graphical-functions.html"><a href="graphical-functions.html"><i class="fa fa-check"></i><b>8</b> Graphical Functions</a></li>
<li class="chapter" data-level="9" data-path="example-lake-erie-harmful-algal-bloom-monitoring.html"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html"><i class="fa fa-check"></i><b>9</b> Example: Lake Erie Harmful Algal Bloom Monitoring</a>
<ul>
<li class="chapter" data-level="9.1" data-path="example-lake-erie-harmful-algal-bloom-monitoring.html"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#data"><i class="fa fa-check"></i><b>9.1</b> Data</a></li>
<li class="chapter" data-level="9.2" data-path="example-lake-erie-harmful-algal-bloom-monitoring.html"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#mc-distribution"><i class="fa fa-check"></i><b>9.2</b> MC Distribution</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="example-lake-erie-harmful-algal-bloom-monitoring.html"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#histogram-and-boxplot"><i class="fa fa-check"></i><b>9.2.1</b> Histogram and boxplot</a></li>
<li class="chapter" data-level="9.2.2" data-path="example-lake-erie-harmful-algal-bloom-monitoring.html"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#comparing-to-the-normal-distribution"><i class="fa fa-check"></i><b>9.2.2</b> Comparing to the normal distribution</a></li>
<li class="chapter" data-level="9.2.3" data-path="example-lake-erie-harmful-algal-bloom-monitoring.html"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#comparing-two-distributions"><i class="fa fa-check"></i><b>9.2.3</b> Comparing Two Distributions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>10</b> Introduction</a></li>
<li class="chapter" data-level="11" data-path="data-1.html"><a href="data-1.html"><i class="fa fa-check"></i><b>11</b> Data</a></li>
<li class="chapter" data-level="12" data-path="using-package-reshape.html"><a href="using-package-reshape.html"><i class="fa fa-check"></i><b>12</b> Using package <code>reshape</code></a></li>
<li class="chapter" data-level="13" data-path="subscripting.html"><a href="subscripting.html"><i class="fa fa-check"></i><b>13</b> Subscripting</a>
<ul>
<li class="chapter" data-level="13.1" data-path="subscripting.html"><a href="subscripting.html#numerical-subscripts"><i class="fa fa-check"></i><b>13.1</b> Numerical Subscripts</a></li>
<li class="chapter" data-level="13.2" data-path="subscripting.html"><a href="subscripting.html#character-subscripts"><i class="fa fa-check"></i><b>13.2</b> Character Subscripts</a></li>
<li class="chapter" data-level="13.3" data-path="subscripting.html"><a href="subscripting.html#logical-subscripts"><i class="fa fa-check"></i><b>13.3</b> Logical Subscripts</a></li>
<li class="chapter" data-level="13.4" data-path="subscripting.html"><a href="subscripting.html#subscripting-matrices"><i class="fa fa-check"></i><b>13.4</b> Subscripting Matrices</a></li>
<li class="chapter" data-level="13.5" data-path="subscripting.html"><a href="subscripting.html#dropfalse"><i class="fa fa-check"></i><b>13.5</b> <code>drop=FALSE</code></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="two-useful-functions-for-matrix.html"><a href="two-useful-functions-for-matrix.html"><i class="fa fa-check"></i><b>14</b> Two Useful Functions for Matrix</a></li>
<li class="chapter" data-level="15" data-path="list.html"><a href="list.html"><i class="fa fa-check"></i><b>15</b> List</a></li>
<li class="chapter" data-level="16" data-path="aggregation.html"><a href="aggregation.html"><i class="fa fa-check"></i><b>16</b> Aggregation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="aggregation.html"><a href="aggregation.html#tabulation"><i class="fa fa-check"></i><b>16.1</b> Tabulation</a></li>
<li class="chapter" data-level="16.2" data-path="aggregation.html"><a href="aggregation.html#general-considerations-of-aggregation"><i class="fa fa-check"></i><b>16.2</b> General Considerations of Aggregation</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="aggregation.html"><a href="aggregation.html#sapply"><i class="fa fa-check"></i><b>16.2.1</b> <code>sapply</code></a></li>
<li class="chapter" data-level="16.2.2" data-path="aggregation.html"><a href="aggregation.html#apply"><i class="fa fa-check"></i><b>16.2.2</b> <code>apply</code></a></li>
<li class="chapter" data-level="16.2.3" data-path="aggregation.html"><a href="aggregation.html#mapping-a-function-based-on-groups"><i class="fa fa-check"></i><b>16.2.3</b> Mapping a Function Based on Groups</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="transform.html"><a href="transform.html"><i class="fa fa-check"></i><b>17</b> Data transformation</a>
<ul>
<li class="chapter" data-level="17.1" data-path="transform.html"><a href="transform.html#introduction-2"><i class="fa fa-check"></i><b>17.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="transform.html"><a href="transform.html#prerequisites"><i class="fa fa-check"></i><b>17.1.1</b> Prerequisites</a></li>
<li class="chapter" data-level="17.1.2" data-path="transform.html"><a href="transform.html#nycflights13"><i class="fa fa-check"></i><b>17.1.2</b> nycflights13</a></li>
<li class="chapter" data-level="17.1.3" data-path="transform.html"><a href="transform.html#dplyr-basics"><i class="fa fa-check"></i><b>17.1.3</b> dplyr basics</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="transform.html"><a href="transform.html#filter-rows-with-filter"><i class="fa fa-check"></i><b>17.2</b> Filter rows with <code>filter()</code></a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="transform.html"><a href="transform.html#comparisons"><i class="fa fa-check"></i><b>17.2.1</b> Comparisons</a></li>
<li class="chapter" data-level="17.2.2" data-path="transform.html"><a href="transform.html#logical-operators"><i class="fa fa-check"></i><b>17.2.2</b> Logical operators</a></li>
<li class="chapter" data-level="17.2.3" data-path="transform.html"><a href="transform.html#missing-values"><i class="fa fa-check"></i><b>17.2.3</b> Missing values</a></li>
<li class="chapter" data-level="17.2.4" data-path="transform.html"><a href="transform.html#exercises"><i class="fa fa-check"></i><b>17.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="transform.html"><a href="transform.html#arrange-rows-with-arrange"><i class="fa fa-check"></i><b>17.3</b> Arrange rows with <code>arrange()</code></a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="transform.html"><a href="transform.html#exercises-1"><i class="fa fa-check"></i><b>17.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="transform.html"><a href="transform.html#select"><i class="fa fa-check"></i><b>17.4</b> Select columns with <code>select()</code></a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="transform.html"><a href="transform.html#exercises-2"><i class="fa fa-check"></i><b>17.4.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="transform.html"><a href="transform.html#add-new-variables-with-mutate"><i class="fa fa-check"></i><b>17.5</b> Add new variables with <code>mutate()</code></a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="transform.html"><a href="transform.html#mutate-funs"><i class="fa fa-check"></i><b>17.5.1</b> Useful creation functions</a></li>
<li class="chapter" data-level="17.5.2" data-path="transform.html"><a href="transform.html#exercises-3"><i class="fa fa-check"></i><b>17.5.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="transform.html"><a href="transform.html#grouped-summaries-with-summarise"><i class="fa fa-check"></i><b>17.6</b> Grouped summaries with <code>summarise()</code></a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="transform.html"><a href="transform.html#combining-multiple-operations-with-the-pipe"><i class="fa fa-check"></i><b>17.6.1</b> Combining multiple operations with the pipe</a></li>
<li class="chapter" data-level="17.6.2" data-path="transform.html"><a href="transform.html#missing-values-1"><i class="fa fa-check"></i><b>17.6.2</b> Missing values</a></li>
<li class="chapter" data-level="17.6.3" data-path="transform.html"><a href="transform.html#counts"><i class="fa fa-check"></i><b>17.6.3</b> Counts</a></li>
<li class="chapter" data-level="17.6.4" data-path="transform.html"><a href="transform.html#summarise-funs"><i class="fa fa-check"></i><b>17.6.4</b> Useful summary functions</a></li>
<li class="chapter" data-level="17.6.5" data-path="transform.html"><a href="transform.html#grouping-by-multiple-variables"><i class="fa fa-check"></i><b>17.6.5</b> Grouping by multiple variables</a></li>
<li class="chapter" data-level="17.6.6" data-path="transform.html"><a href="transform.html#ungrouping"><i class="fa fa-check"></i><b>17.6.6</b> Ungrouping</a></li>
<li class="chapter" data-level="17.6.7" data-path="transform.html"><a href="transform.html#exercises-4"><i class="fa fa-check"></i><b>17.6.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="transform.html"><a href="transform.html#grouped-mutates-and-filters"><i class="fa fa-check"></i><b>17.7</b> Grouped mutates (and filters)</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="transform.html"><a href="transform.html#exercises-5"><i class="fa fa-check"></i><b>17.7.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="package-reshape.html"><a href="package-reshape.html"><i class="fa fa-check"></i><b>18</b> Package <code>reshape</code></a>
<ul>
<li class="chapter" data-level="18.1" data-path="package-reshape.html"><a href="package-reshape.html#melting-data"><i class="fa fa-check"></i><b>18.1</b> Melting data</a></li>
<li class="chapter" data-level="18.2" data-path="package-reshape.html"><a href="package-reshape.html#casting-molten-data"><i class="fa fa-check"></i><b>18.2</b> Casting molten data</a></li>
<li class="chapter" data-level="18.3" data-path="package-reshape.html"><a href="package-reshape.html#the-french-fries-example"><i class="fa fa-check"></i><b>18.3</b> The French Fries Example</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="package-reshape2.html"><a href="package-reshape2.html"><i class="fa fa-check"></i><b>19</b> Package <code>reshape2</code></a></li>
<li class="chapter" data-level="20" data-path="reshaping-data.html"><a href="reshaping-data.html"><i class="fa fa-check"></i><b>20</b> Reshaping Data</a>
<ul>
<li class="chapter" data-level="20.1" data-path="reshaping-data.html"><a href="reshaping-data.html#modifying-data-frame-variables"><i class="fa fa-check"></i><b>20.1</b> Modifying data frame variables</a></li>
<li class="chapter" data-level="20.2" data-path="reshaping-data.html"><a href="reshaping-data.html#reshaping-a-data-frame"><i class="fa fa-check"></i><b>20.2</b> Reshaping a data frame</a></li>
<li class="chapter" data-level="20.3" data-path="reshaping-data.html"><a href="reshaping-data.html#function-reshape"><i class="fa fa-check"></i><b>20.3</b> Function <code>reshape</code></a></li>
<li class="chapter" data-level="20.4" data-path="reshaping-data.html"><a href="reshaping-data.html#combining-data-frames"><i class="fa fa-check"></i><b>20.4</b> Combining Data Frames</a></li>
<li class="chapter" data-level="20.5" data-path="reshaping-data.html"><a href="reshaping-data.html#merging-using-index"><i class="fa fa-check"></i><b>20.5</b> Merging using index</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="a-quick-review.html"><a href="a-quick-review.html"><i class="fa fa-check"></i><b>21</b> A quick review</a>
<ul>
<li class="chapter" data-level="21.1" data-path="a-quick-review.html"><a href="a-quick-review.html#data-in-r"><i class="fa fa-check"></i><b>21.1</b> Data in R</a></li>
<li class="chapter" data-level="21.2" data-path="a-quick-review.html"><a href="a-quick-review.html#reading-and-writing-data"><i class="fa fa-check"></i><b>21.2</b> Reading and writing data</a></li>
<li class="chapter" data-level="21.3" data-path="a-quick-review.html"><a href="a-quick-review.html#dates"><i class="fa fa-check"></i><b>21.3</b> Dates</a></li>
<li class="chapter" data-level="21.4" data-path="a-quick-review.html"><a href="a-quick-review.html#subscripting-1"><i class="fa fa-check"></i><b>21.4</b> Subscripting</a></li>
<li class="chapter" data-level="21.5" data-path="a-quick-review.html"><a href="a-quick-review.html#data-aggregation"><i class="fa fa-check"></i><b>21.5</b> Data aggregation</a></li>
<li class="chapter" data-level="21.6" data-path="a-quick-review.html"><a href="a-quick-review.html#data-reshaping"><i class="fa fa-check"></i><b>21.6</b> Data reshaping</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="introduction-3.html"><a href="introduction-3.html"><i class="fa fa-check"></i><b>22</b> Introduction</a>
<ul>
<li class="chapter" data-level="22.1" data-path="introduction-3.html"><a href="introduction-3.html#example-1"><i class="fa fa-check"></i><b>22.1</b> Example 1:</a></li>
<li class="chapter" data-level="22.2" data-path="introduction-3.html"><a href="introduction-3.html#example-2"><i class="fa fa-check"></i><b>22.2</b> Example 2:</a></li>
<li class="chapter" data-level="22.3" data-path="introduction-3.html"><a href="introduction-3.html#example-4"><i class="fa fa-check"></i><b>22.3</b> Example 4:</a></li>
<li class="chapter" data-level="22.4" data-path="introduction-3.html"><a href="introduction-3.html#example-5"><i class="fa fa-check"></i><b>22.4</b> Example 5:</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="types-of-arguments.html"><a href="types-of-arguments.html"><i class="fa fa-check"></i><b>23</b> Types of arguments</a>
<ul>
<li class="chapter" data-level="23.1" data-path="types-of-arguments.html"><a href="types-of-arguments.html#example-6"><i class="fa fa-check"></i><b>23.1</b> Example 6:</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="default-arguments.html"><a href="default-arguments.html"><i class="fa fa-check"></i><b>24</b> Default arguments</a>
<ul>
<li class="chapter" data-level="24.1" data-path="default-arguments.html"><a href="default-arguments.html#example-7"><i class="fa fa-check"></i><b>24.1</b> Example 7:</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="recursive-function.html"><a href="recursive-function.html"><i class="fa fa-check"></i><b>25</b> Recursive Function</a></li>
<li class="chapter" data-level="26" data-path="two-real-example.html"><a href="two-real-example.html"><i class="fa fa-check"></i><b>26</b> Two Real Example</a>
<ul>
<li class="chapter" data-level="26.1" data-path="two-real-example.html"><a href="two-real-example.html#importing-elisa-test-data"><i class="fa fa-check"></i><b>26.1</b> Importing ELISA Test Data</a></li>
<li class="chapter" data-level="26.2" data-path="two-real-example.html"><a href="two-real-example.html#the-hockey-stick-model"><i class="fa fa-check"></i><b>26.2</b> The Hockey Stick Model</a></li>
<li class="chapter" data-level="26.3" data-path="two-real-example.html"><a href="two-real-example.html#sparrow-model"><i class="fa fa-check"></i><b>26.3</b> SPARROW model</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="good-function-writing-practices.html"><a href="good-function-writing-practices.html"><i class="fa fa-check"></i><b>27</b> Good function writing practices</a></li>
<li class="chapter" data-level="28" data-path="package-tidyr.html"><a href="package-tidyr.html"><i class="fa fa-check"></i><b>28</b> Package <code>tidyr</code></a></li>
<li class="chapter" data-level="29" data-path="package-reshape2-1.html"><a href="package-reshape2-1.html"><i class="fa fa-check"></i><b>29</b> Package <code>reshape2</code></a>
<ul>
<li class="chapter" data-level="29.1" data-path="package-reshape2-1.html"><a href="package-reshape2-1.html#long-versus-wide"><i class="fa fa-check"></i><b>29.1</b> Long versus Wide</a></li>
<li class="chapter" data-level="29.2" data-path="package-reshape2-1.html"><a href="package-reshape2-1.html#reshape2"><i class="fa fa-check"></i><b>29.2</b> <code>reshape2</code></a>
<ul>
<li class="chapter" data-level="29.2.1" data-path="package-reshape2-1.html"><a href="package-reshape2-1.html#wide--to-long-format-data-the-melt-function"><i class="fa fa-check"></i><b>29.2.1</b> Wide- to long-format data: the <code>melt</code> function</a></li>
<li class="chapter" data-level="29.2.2" data-path="package-reshape2-1.html"><a href="package-reshape2-1.html#long--to-wide-format-data-the-cast-functions"><i class="fa fa-check"></i><b>29.2.2</b> Long- to wide-format data: the cast functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="tidyr-versus-reshape2.html"><a href="tidyr-versus-reshape2.html"><i class="fa fa-check"></i><b>30</b> <code>tidyr</code> versus <code>reshape2</code></a>
<ul>
<li class="chapter" data-level="30.1" data-path="tidyr-versus-reshape2.html"><a href="tidyr-versus-reshape2.html#data-tidying"><i class="fa fa-check"></i><b>30.1</b> Data tidying</a>
<ul>
<li class="chapter" data-level="30.1.1" data-path="tidyr-versus-reshape2.html"><a href="tidyr-versus-reshape2.html#from-the-wide-to-the-long-format-gather-vs-melt"><i class="fa fa-check"></i><b>30.1.1</b> From the wide to the long format: <code>gather()</code> vs <code>melt()</code></a></li>
<li class="chapter" data-level="30.1.2" data-path="tidyr-versus-reshape2.html"><a href="tidyr-versus-reshape2.html#split-a-column-separate-vs-colsplit"><i class="fa fa-check"></i><b>30.1.2</b> Split a column: <code>separate()</code> vs <code>colsplit()</code></a></li>
<li class="chapter" data-level="30.1.3" data-path="tidyr-versus-reshape2.html"><a href="tidyr-versus-reshape2.html#from-the-long-to-the-wide-format-spread-vs-dcast"><i class="fa fa-check"></i><b>30.1.3</b> From the long to the wide format: <code>spread()</code> vs <code>dcast()</code></a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="tidyr-versus-reshape2.html"><a href="tidyr-versus-reshape2.html#data-aggregation-1"><i class="fa fa-check"></i><b>30.2</b> Data aggregation</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="factors.html"><a href="factors.html"><i class="fa fa-check"></i><b>31</b> Factors</a>
<ul>
<li class="chapter" data-level="31.1" data-path="factors.html"><a href="factors.html#numeric-factors"><i class="fa fa-check"></i><b>31.1</b> Numeric Factors</a></li>
<li class="chapter" data-level="31.2" data-path="factors.html"><a href="factors.html#manipulating-factors"><i class="fa fa-check"></i><b>31.2</b> Manipulating Factors</a></li>
<li class="chapter" data-level="31.3" data-path="factors.html"><a href="factors.html#creating-factors-from-continuous-variables"><i class="fa fa-check"></i><b>31.3</b> Creating Factors from Continuous Variables</a></li>
<li class="chapter" data-level="31.4" data-path="factors.html"><a href="factors.html#factors-based-on-dates-and-times"><i class="fa fa-check"></i><b>31.4</b> Factors Based on Dates and Times</a></li>
<li class="chapter" data-level="31.5" data-path="factors.html"><a href="factors.html#interactions"><i class="fa fa-check"></i><b>31.5</b> Interactions</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="character-manipulation.html"><a href="character-manipulation.html"><i class="fa fa-check"></i><b>32</b> Character Manipulation</a>
<ul>
<li class="chapter" data-level="32.1" data-path="character-manipulation.html"><a href="character-manipulation.html#regular-expressions-in-r"><i class="fa fa-check"></i><b>32.1</b> Regular Expressions in R</a></li>
<li class="chapter" data-level="32.2" data-path="character-manipulation.html"><a href="character-manipulation.html#breaking-apart-character-values"><i class="fa fa-check"></i><b>32.2</b> Breaking Apart Character Values</a></li>
<li class="chapter" data-level="32.3" data-path="character-manipulation.html"><a href="character-manipulation.html#substitutions-and-tagging"><i class="fa fa-check"></i><b>32.3</b> Substitutions and Tagging</a></li>
<li class="chapter" data-level="32.4" data-path="character-manipulation.html"><a href="character-manipulation.html#a-quick-summary"><i class="fa fa-check"></i><b>32.4</b> A Quick Summary</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="introduction-4.html"><a href="introduction-4.html"><i class="fa fa-check"></i><b>33</b> Introduction</a></li>
<li class="chapter" data-level="34" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>34</b> Examples</a>
<ul>
<li class="chapter" data-level="34.1" data-path="examples.html"><a href="examples.html#example-1-1"><i class="fa fa-check"></i><b>34.1</b> Example 1</a></li>
<li class="chapter" data-level="34.2" data-path="examples.html"><a href="examples.html#example-2-1"><i class="fa fa-check"></i><b>34.2</b> Example 2</a></li>
<li class="chapter" data-level="34.3" data-path="examples.html"><a href="examples.html#using-lattice-package"><i class="fa fa-check"></i><b>34.3</b> Using Lattice Package</a></li>
<li class="chapter" data-level="34.4" data-path="examples.html"><a href="examples.html#using-lattice-functions"><i class="fa fa-check"></i><b>34.4</b> Using Lattice Functions</a></li>
<li class="chapter" data-level="34.5" data-path="examples.html"><a href="examples.html#custom-panel-functions"><i class="fa fa-check"></i><b>34.5</b> Custom Panel Functions</a></li>
<li class="chapter" data-level="34.6" data-path="examples.html"><a href="examples.html#the-example-that-started-trellis"><i class="fa fa-check"></i><b>34.6</b> The Example That Started Trellis</a></li>
<li class="chapter" data-level="34.7" data-path="examples.html"><a href="examples.html#an-example-of-graphical-exploratory-data-analysis"><i class="fa fa-check"></i><b>34.7</b> An Example of Graphical Exploratory Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="introduction-5.html"><a href="introduction-5.html"><i class="fa fa-check"></i><b>35</b> Introduction</a></li>
<li class="chapter" data-level="36" data-path="examples-1.html"><a href="examples-1.html"><i class="fa fa-check"></i><b>36</b> Examples</a>
<ul>
<li class="chapter" data-level="36.1" data-path="examples-1.html"><a href="examples-1.html#example-1-2"><i class="fa fa-check"></i><b>36.1</b> Example 1</a></li>
<li class="chapter" data-level="36.2" data-path="examples-1.html"><a href="examples-1.html#example-2-2"><i class="fa fa-check"></i><b>36.2</b> Example 2</a></li>
<li class="chapter" data-level="36.3" data-path="examples-1.html"><a href="examples-1.html#using-lattice-package-1"><i class="fa fa-check"></i><b>36.3</b> Using Lattice Package</a></li>
<li class="chapter" data-level="36.4" data-path="examples-1.html"><a href="examples-1.html#using-lattice-functions-1"><i class="fa fa-check"></i><b>36.4</b> Using Lattice Functions</a></li>
<li class="chapter" data-level="36.5" data-path="examples-1.html"><a href="examples-1.html#costom-panel-functions"><i class="fa fa-check"></i><b>36.5</b> Costom Panel Functions</a></li>
<li class="chapter" data-level="36.6" data-path="examples-1.html"><a href="examples-1.html#the-example-that-started-trellis-1"><i class="fa fa-check"></i><b>36.6</b> The Example That Started Trellis</a></li>
<li class="chapter" data-level="36.7" data-path="examples-1.html"><a href="examples-1.html#an-example-of-graphical-exploratory-data-analysis-1"><i class="fa fa-check"></i><b>36.7</b> An Example of Graphical Exploratory Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="introduction-6.html"><a href="introduction-6.html"><i class="fa fa-check"></i><b>37</b> Introduction</a>
<ul>
<li class="chapter" data-level="37.1" data-path="introduction-6.html"><a href="introduction-6.html#filter"><i class="fa fa-check"></i><b>37.1</b> Filter</a></li>
<li class="chapter" data-level="37.2" data-path="introduction-6.html"><a href="introduction-6.html#mutate"><i class="fa fa-check"></i><b>37.2</b> Mutate</a></li>
<li class="chapter" data-level="37.3" data-path="introduction-6.html"><a href="introduction-6.html#summarise"><i class="fa fa-check"></i><b>37.3</b> Summarise</a></li>
<li class="chapter" data-level="37.4" data-path="introduction-6.html"><a href="introduction-6.html#group-by"><i class="fa fa-check"></i><b>37.4</b> Group By</a></li>
<li class="chapter" data-level="37.5" data-path="introduction-6.html"><a href="introduction-6.html#sample"><i class="fa fa-check"></i><b>37.5</b> Sample</a></li>
<li class="chapter" data-level="37.6" data-path="introduction-6.html"><a href="introduction-6.html#count"><i class="fa fa-check"></i><b>37.6</b> Count</a></li>
<li class="chapter" data-level="37.7" data-path="introduction-6.html"><a href="introduction-6.html#arrange"><i class="fa fa-check"></i><b>37.7</b> Arrange</a></li>
<li class="chapter" data-level="37.8" data-path="introduction-6.html"><a href="introduction-6.html#pipe"><i class="fa fa-check"></i><b>37.8</b> Pipe</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html"><i class="fa fa-check"></i><b>38</b> Explaining <code>dplyr</code> – A More Complicated Example</a>
<ul>
<li class="chapter" data-level="38.1" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#data-nycflights13"><i class="fa fa-check"></i><b>38.1</b> Data: <code>nycflights13</code></a></li>
<li class="chapter" data-level="38.2" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#single-table-verbs"><i class="fa fa-check"></i><b>38.2</b> Single table verbs</a></li>
<li class="chapter" data-level="38.3" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#filter-rows-with-filter-1"><i class="fa fa-check"></i><b>38.3</b> Filter rows with <code>filter()</code></a></li>
<li class="chapter" data-level="38.4" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#arrange-rows-with-arrange-1"><i class="fa fa-check"></i><b>38.4</b> Arrange rows with <code>arrange()</code></a></li>
<li class="chapter" data-level="38.5" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#select-columns-with-select"><i class="fa fa-check"></i><b>38.5</b> Select columns with <code>select()</code></a></li>
<li class="chapter" data-level="38.6" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#extract-distinct-unique-rows"><i class="fa fa-check"></i><b>38.6</b> Extract distinct (unique) rows</a></li>
<li class="chapter" data-level="38.7" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#add-new-columns-with-mutate"><i class="fa fa-check"></i><b>38.7</b> Add new columns with mutate()</a></li>
<li class="chapter" data-level="38.8" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#summarise-values-with-summarise"><i class="fa fa-check"></i><b>38.8</b> Summarise values with <code>summarise()</code></a></li>
<li class="chapter" data-level="38.9" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#randomly-sample-rows-with-sample_n-and-sample_frac"><i class="fa fa-check"></i><b>38.9</b> Randomly sample rows with sample_n() and sample_frac()</a></li>
<li class="chapter" data-level="38.10" data-path="explaining-dplyr-a-more-complicated-example.html"><a href="explaining-dplyr-a-more-complicated-example.html#commonalities"><i class="fa fa-check"></i><b>38.10</b> Commonalities</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="grouped-operations.html"><a href="grouped-operations.html"><i class="fa fa-check"></i><b>39</b> Grouped operations</a>
<ul>
<li class="chapter" data-level="39.1" data-path="grouped-operations.html"><a href="grouped-operations.html#chaining"><i class="fa fa-check"></i><b>39.1</b> Chaining</a></li>
<li class="chapter" data-level="39.2" data-path="grouped-operations.html"><a href="grouped-operations.html#a-quick-summary-1"><i class="fa fa-check"></i><b>39.2</b> A quick Summary</a>
<ul>
<li class="chapter" data-level="39.2.1" data-path="grouped-operations.html"><a href="grouped-operations.html#dplyr-verbs-in-action"><i class="fa fa-check"></i><b>39.2.1</b> dplyr verbs in action</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="40" data-path="a-quick-recap.html"><a href="a-quick-recap.html"><i class="fa fa-check"></i><b>40</b> A Quick Recap</a>
<ul>
<li class="chapter" data-level="40.1" data-path="a-quick-recap.html"><a href="a-quick-recap.html#costom-panel-functions-1"><i class="fa fa-check"></i><b>40.1</b> Costom Panel Functions</a></li>
<li class="chapter" data-level="40.2" data-path="a-quick-recap.html"><a href="a-quick-recap.html#the-example-that-started-trellis-2"><i class="fa fa-check"></i><b>40.2</b> The Example That Started Trellis</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="types-of-data.html"><a href="types-of-data.html"><i class="fa fa-check"></i><b>41</b> Types of Data</a>
<ul>
<li class="chapter" data-level="41.1" data-path="types-of-data.html"><a href="types-of-data.html#univariate-data"><i class="fa fa-check"></i><b>41.1</b> Univariate data</a></li>
<li class="chapter" data-level="41.2" data-path="types-of-data.html"><a href="types-of-data.html#fits-and-residuals"><i class="fa fa-check"></i><b>41.2</b> Fits and Residuals</a>
<ul>
<li class="chapter" data-level="41.2.1" data-path="types-of-data.html"><a href="types-of-data.html#homogeneity-and-pooling"><i class="fa fa-check"></i><b>41.2.1</b> Homogeneity and Pooling</a></li>
<li class="chapter" data-level="41.2.2" data-path="types-of-data.html"><a href="types-of-data.html#checking-for-normality-of-the-pooled-residuals"><i class="fa fa-check"></i><b>41.2.2</b> Checking for normality of the pooled residuals</a></li>
<li class="chapter" data-level="41.2.3" data-path="types-of-data.html"><a href="types-of-data.html#the-rfs-plot"><i class="fa fa-check"></i><b>41.2.3</b> The <code>rfs</code> plot</a></li>
</ul></li>
<li class="chapter" data-level="41.3" data-path="types-of-data.html"><a href="types-of-data.html#bivariate-data"><i class="fa fa-check"></i><b>41.3</b> Bivariate data</a></li>
<li class="chapter" data-level="41.4" data-path="types-of-data.html"><a href="types-of-data.html#trivariate-and-hypervariate-data"><i class="fa fa-check"></i><b>41.4</b> Trivariate and hypervariate data</a></li>
<li class="chapter" data-level="41.5" data-path="types-of-data.html"><a href="types-of-data.html#multiway-data"><i class="fa fa-check"></i><b>41.5</b> Multiway data</a></li>
</ul></li>
<li class="chapter" data-level="42" data-path="univariate-data-displaying-and-comparing-distributions.html"><a href="univariate-data-displaying-and-comparing-distributions.html"><i class="fa fa-check"></i><b>42</b> Univariate Data – Displaying and Comparing Distributions</a>
<ul>
<li class="chapter" data-level="42.1" data-path="univariate-data-displaying-and-comparing-distributions.html"><a href="univariate-data-displaying-and-comparing-distributions.html#displaying-distribution"><i class="fa fa-check"></i><b>42.1</b> Displaying distribution</a></li>
<li class="chapter" data-level="42.2" data-path="univariate-data-displaying-and-comparing-distributions.html"><a href="univariate-data-displaying-and-comparing-distributions.html#comparing-distributions"><i class="fa fa-check"></i><b>42.2</b> Comparing distributions</a></li>
<li class="chapter" data-level="42.3" data-path="univariate-data-displaying-and-comparing-distributions.html"><a href="univariate-data-displaying-and-comparing-distributions.html#an-example-of-graphical-exploratory-data-analysis-2"><i class="fa fa-check"></i><b>42.3</b> An Example of Graphical Exploratory Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="43" data-path="a-summary.html"><a href="a-summary.html"><i class="fa fa-check"></i><b>43</b> A Summary</a>
<ul>
<li class="chapter" data-level="43.1" data-path="a-summary.html"><a href="a-summary.html#types-of-data-1"><i class="fa fa-check"></i><b>43.1</b> Types of Data</a>
<ul>
<li class="chapter" data-level="43.1.1" data-path="a-summary.html"><a href="a-summary.html#checking-for-normality-of-the-pooled-residuals-1"><i class="fa fa-check"></i><b>43.1.1</b> Checking for normality of the pooled residuals</a></li>
<li class="chapter" data-level="43.1.2" data-path="a-summary.html"><a href="a-summary.html#the-rfs-plot-1"><i class="fa fa-check"></i><b>43.1.2</b> The <code>rfs</code> plot</a></li>
</ul></li>
<li class="chapter" data-level="43.2" data-path="a-summary.html"><a href="a-summary.html#additive-versus-multiplicative-shifts"><i class="fa fa-check"></i><b>43.2</b> Additive versus multiplicative shifts</a></li>
<li class="chapter" data-level="43.3" data-path="a-summary.html"><a href="a-summary.html#using-q-q-plot-to-check-for-additive-shift"><i class="fa fa-check"></i><b>43.3</b> Using Q-Q plot to Check for Additive Shift</a></li>
<li class="chapter" data-level="43.4" data-path="a-summary.html"><a href="a-summary.html#transformation-to-normality"><i class="fa fa-check"></i><b>43.4</b> Transformation to Normality</a></li>
<li class="chapter" data-level="43.5" data-path="a-summary.html"><a href="a-summary.html#an-example-of-graphical-exploratory-data-analysis-3"><i class="fa fa-check"></i><b>43.5</b> An Example of Graphical Exploratory Data Analysis</a></li>
<li class="chapter" data-level="43.6" data-path="a-summary.html"><a href="a-summary.html#nutrient-loading-and-flow-from-maumee"><i class="fa fa-check"></i><b>43.6</b> Nutrient Loading and Flow from Maumee</a>
<ul>
<li class="chapter" data-level="43.6.1" data-path="a-summary.html"><a href="a-summary.html#objectives"><i class="fa fa-check"></i><b>43.6.1</b> Objectives</a></li>
<li class="chapter" data-level="43.6.2" data-path="a-summary.html"><a href="a-summary.html#methods"><i class="fa fa-check"></i><b>43.6.2</b> Methods</a></li>
<li class="chapter" data-level="43.6.3" data-path="a-summary.html"><a href="a-summary.html#results"><i class="fa fa-check"></i><b>43.6.3</b> Results</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Environmental Data Management</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="example-lake-erie-harmful-algal-bloom-monitoring" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Example: Lake Erie Harmful Algal Bloom Monitoring</h1>
<p>Environmental factors affecting the production of cyanobacterial toxin are explored using two large data sets to support developing strategies for con- trolling and mitigating harmful blooms. Although nutrients, particularly phosphorus, oversupply is the consensus root cause of harmful blooms, factors affecting the production of cyanotoxins are less well studied. Using two large data sets, we analyze the potential factors associated with the variation of microcystin concentrations with an aim of developing a predictive model</p>
<div id="data" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Data</h2>
<p>Reading data and plot sampling sites using R map</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb49-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## non-detect (nd, bd, below detect) are replaced with 0</span></span>
<span id="cb49-2"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## secchi &gt;x is replaced with x (x = 7 or 5)</span></span>
<span id="cb49-3"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb49-4" aria-hidden="true" tabindex="-1"></a>eriedata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste</span>(dataDIR, <span class="st">&quot;ErieData.csv&quot;</span>, <span class="at">sep=</span><span class="st">&quot;/&quot;</span>), <span class="at">header=</span>T)</span>
<span id="cb49-5"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(eriedata)</span></code></pre></div>
<pre><code>##   Station Year    Day    Date Time Latitude Longitude Depth Secchi Temp Co0
## 1     LE1 2008 26-Jun 6/26/08        41.750    83.104    NA    3.4   NA  NA
## 2     LE2 2008 26-Jun 6/26/08        41.821    83.186    NA    4.9   NA  NA
## 3     LE3 2008 26-Jun 6/26/08        41.788    83.356    NA    3.2   NA  NA
## 4     LE4 2008 26-Jun 6/26/08        41.742    83.401    NA    2.2   NA  NA
## 5     LE5 2008 26-Jun 6/26/08        41.716    83.455    NA    0.2   NA  NA
## 6     LE6 2008 26-Jun 6/26/08        41.733    83.297    NA    1.4   NA  NA
##   SpCo0 BeamAtten Transmission chla PC PAR DO au.chl AquaFluor_PC AquaFluor_CHL
## 1    NA        NA           NA   NA NA  NA NA     NA           NA            NA
## 2    NA        NA           NA   NA NA  NA NA     NA           NA            NA
## 3    NA        NA           NA   NA NA  NA NA     NA           NA            NA
## 4    NA        NA           NA   NA NA  NA NA     NA           NA            NA
## 5    NA        NA           NA   NA NA  NA NA     NA           NA            NA
## 6    NA        NA           NA   NA NA  NA NA     NA           NA            NA
##   Turbidity     TP TDP SRP NH4 NO3 SiO2 Cl TSS VSS POC PON DOC ExChla ExPC  pMC
## 1        NA  21.67  NA  NA  NA  NA   NA NA  NA  NA  NA  NA  NA   1.54   NA 0.02
## 2        NA  22.61  NA  NA  NA  NA   NA NA  NA  NA  NA  NA  NA   2.15   NA 0.01
## 3        NA  58.16  NA  NA  NA  NA   NA NA  NA  NA  NA  NA  NA   1.72   NA 0.01
## 4        NA  71.25  NA  NA  NA  NA   NA NA  NA  NA  NA  NA  NA   2.22   NA 0.03
## 5        NA 245.25  NA  NA  NA  NA   NA NA  NA  NA  NA  NA  NA  51.20   NA 0.13
## 6        NA  39.45  NA  NA  NA  NA   NA NA  NA  NA  NA  NA  NA   9.60   NA 0.03
##   dMC pMC_LC_MS TCyanos_cells TCyanos_volume
## 1  NA        NA            NA             NA
## 2  NA        NA            NA             NA
## 3  NA        NA            NA             NA
## 4  NA        NA            NA             NA
## 5  NA        NA            NA             NA
## 6  NA        NA            NA             NA</code></pre>
<p>Data points are labeled by sites (a separate variable). However, because
these sampling sites are in the middle of a big lake, each visit to a site
is based on a GPS reading. A first step is to see if there are any errors
in the locations of sampling sites. First, I will check the latitude and
longitude of all sites:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb51-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Latitude<span class="sc">~</span>Longitude, <span class="at">data=</span>eriedata)</span></code></pre></div>
<p><img src="RGraphics_Introduction_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb52-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Five data entry errors:</span></span>
<span id="cb52-2"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">##  1. Latitude for WE8 (10/21/13) was 875.7333 --</span></span>
<span id="cb52-3"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">##     replaced mean latitude of other WE8 with Latitude &lt; 48</span></span>
<span id="cb52-4"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">##  2. Latitude for WE8 (8/13/12) was 49.8369 --</span></span>
<span id="cb52-5"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">##     replaced mean latitude of other WE8 with Latitude &lt; 48</span></span>
<span id="cb52-6"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb52-6" aria-hidden="true" tabindex="-1"></a>  eriedata<span class="sc">$</span>Latitude[eriedata<span class="sc">$</span>Latitude<span class="sc">&gt;</span><span class="dv">48</span>] <span class="ot">&lt;-</span></span>
<span id="cb52-7"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb52-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>(eriedata<span class="sc">$</span>Latitude[eriedata<span class="sc">$</span>Station<span class="sc">==</span><span class="st">&quot;WE8&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb52-8"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb52-8" aria-hidden="true" tabindex="-1"></a>                                 eriedata<span class="sc">$</span>Latitude <span class="sc">&lt;</span> <span class="dv">48</span>])</span>
<span id="cb52-9"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">##  3. Longitude for WE4 (10/15/14) was 88.1940 -- should be 83.1940?</span></span>
<span id="cb52-10"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb52-10" aria-hidden="true" tabindex="-1"></a>  eriedata<span class="sc">$</span>Longitude[eriedata<span class="sc">$</span>Longitude<span class="sc">&gt;</span><span class="dv">87</span>] <span class="ot">&lt;-</span></span>
<span id="cb52-11"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb52-11" aria-hidden="true" tabindex="-1"></a>      eriedata<span class="sc">$</span>Longitude[eriedata<span class="sc">$</span>Longitude<span class="sc">&gt;</span><span class="dv">87</span>]<span class="sc">-</span><span class="dv">5</span></span>
<span id="cb52-12"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">##  4. Latitude for WE7 (7/6/10) was 40.7649 -- should be 41.6749?</span></span>
<span id="cb52-13"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb52-13" aria-hidden="true" tabindex="-1"></a>  eriedata<span class="sc">$</span>Latitude[eriedata<span class="sc">$</span>Latitude<span class="sc">&lt;</span><span class="fl">41.1</span> <span class="sc">&amp;</span></span>
<span id="cb52-14"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb52-14" aria-hidden="true" tabindex="-1"></a>                        eriedata<span class="sc">$</span>Station <span class="sc">==</span> <span class="st">&quot;WE7&quot;</span>] <span class="ot">&lt;-</span> <span class="fl">41.6749</span></span>
<span id="cb52-15"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="do">##  5. Latitude for WE 2 (5/15/12) was 41.0127 -- 41.7627?</span></span>
<span id="cb52-16"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb52-16" aria-hidden="true" tabindex="-1"></a>  eriedata<span class="sc">$</span>Latitude[eriedata<span class="sc">$</span>Latitude<span class="sc">&lt;</span><span class="fl">41.1</span> <span class="sc">&amp;</span></span>
<span id="cb52-17"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb52-17" aria-hidden="true" tabindex="-1"></a>                        eriedata<span class="sc">$</span>Station <span class="sc">==</span> <span class="st">&quot;WE2&quot;</span>] <span class="ot">&lt;-</span> <span class="fl">41.7622</span></span></code></pre></div>
<p>Once location errors are corrected, sampling sites are plotted on a map</p>
<pre><code>  eriedata$Longitude &lt;- -eriedata$Longitude
  erieLOC &lt;- eriedata[,c(&quot;Latitude&quot;,&quot;Longitude&quot;)]
  coordinates(erieLOC) &lt;- c(&quot;Longitude&quot;,&quot;Latitude&quot;)

### using maps:
  my.box&lt;-function(xlim, ylim, ...){
      segments(x0=xlim, y0=rep(ylim[1],2), x1=xlim, y1=rep(ylim[2], 2), ...)
      segments(y0=ylim, x0=rep(xlim[1],2), y1=ylim, x1=rep(xlim[2], 2), ...)
  }

##tikz(file=paste(plotDIR, &quot;sampleLOC.tex&quot;, sep=&quot;/&quot;),
##       height=7, width=7,standAlone=F)
  par(mar=rep(0, 4))
  map(&quot;usa&quot;, fill=TRUE, col=&quot;grey80&quot;, xlim=c(-83.5,-82.5),
      ylim=c(41.4, 42.1))
  plot(erieLOC, pch=2, col=&quot;blue&quot;, add=T)

  maplocs &lt;- map(projection=&quot;sp_mercator&quot;, wrap=TRUE, lwd=0.1,
                 col=&quot;grey&quot;, xlim=c(-180, 0),
                 interior=FALSE, orientation=c(90, 180, 0), add=TRUE,
                 plot=FALSE)
  xrange &lt;- range(maplocs$x, na.rm=TRUE)
  yrange &lt;- range(maplocs$y, na.rm=TRUE)
  aspect &lt;- abs(diff(yrange))/abs(diff(xrange))
  # customised to 6.5 by 4.5 figure size
  par(fig=c(0.5, 0.99, 0.99 - 0.5*aspect*4.5/6.5, 0.99),
      mar=rep(0, 4), new=TRUE)
  plot.new()
  plot.window(xlim=c(1,2.00),
              ylim=c(0.45,1))
  map(projection=&quot;sp_mercator&quot;, wrap=TRUE, lwd=0.25, fill=F,
      col=gray(0.25), interior=TRUE, orientation=c(90, 180, 0),
      add=TRUE)
  my.box(xlim=c(1.7-0.015,1.725-0.015), ylim=c(0.79, 0.81))</code></pre>
<p>Summary statistics is almost always a good place to start when examine a data file.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(eriedata)</span></code></pre></div>
<pre><code>##    Station               Year          Day                Date          
##  Length:730         Min.   :2008   Length:730         Length:730        
##  Class :character   1st Qu.:2009   Class :character   Class :character  
##  Mode  :character   Median :2010   Mode  :character   Mode  :character  
##                     Mean   :2011                                        
##                     3rd Qu.:2013                                        
##                     Max.   :2014                                        
##                                                                         
##      Time              Latitude       Longitude         Depth       
##  Length:730         Min.   :41.48   Min.   :81.64   Min.   : 0.200  
##  Class :character   1st Qu.:41.72   1st Qu.:83.19   1st Qu.: 3.800  
##  Mode  :character   Median :41.76   Median :83.32   Median : 5.000  
##                     Mean   :41.77   Mean   :83.26   Mean   : 5.463  
##                     3rd Qu.:41.83   3rd Qu.:83.36   3rd Qu.: 7.500  
##                     Max.   :41.95   Max.   :83.60   Max.   :23.000  
##                                                     NA&#39;s   :107     
##      Secchi           Temp            Co0            SpCo0      
##  Min.   :0.000   Min.   : 7.40   Min.   :175.5   Min.   :220.2  
##  1st Qu.:0.600   1st Qu.:21.20   1st Qu.:234.6   1st Qu.:265.7  
##  Median :1.200   Median :23.30   Median :268.3   Median :289.6  
##  Mean   :1.419   Mean   :22.72   Mean   :277.6   Mean   :301.3  
##  3rd Qu.:1.900   3rd Qu.:25.60   3rd Qu.:308.2   3rd Qu.:330.8  
##  Max.   :9.200   Max.   :30.90   Max.   :456.9   Max.   :474.0  
##  NA&#39;s   :28      NA&#39;s   :69      NA&#39;s   :520     NA&#39;s   :520    
##    BeamAtten       Transmission         chla              PC       
##  Min.   : 0.000   Min.   :  0.00   Min.   : 0.580   Min.   :  480  
##  1st Qu.: 1.800   1st Qu.: 15.00   1st Qu.: 2.245   1st Qu.: 1379  
##  Median : 4.000   Median : 37.60   Median : 3.675   Median : 2653  
##  Mean   : 6.087   Mean   : 40.91   Mean   : 4.871   Mean   : 5956  
##  3rd Qu.: 7.700   3rd Qu.: 64.20   3rd Qu.: 6.715   3rd Qu.: 7909  
##  Max.   :24.900   Max.   :100.00   Max.   :33.130   Max.   :33894  
##  NA&#39;s   :533      NA&#39;s   :533      NA&#39;s   :634      NA&#39;s   :638    
##       PAR               DO             au.chl         AquaFluor_PC    
##  Min.   :   1.0   Min.   : 5.310   Min.   : 0.0400   Min.   :  0.030  
##  1st Qu.:  87.0   1st Qu.: 7.290   1st Qu.: 0.2275   1st Qu.:  0.495  
##  Median : 218.5   Median : 7.680   Median : 0.4350   Median :  1.315  
##  Mean   : 387.7   Mean   : 7.798   Mean   : 0.7112   Mean   :  3.596  
##  3rd Qu.: 530.0   3rd Qu.: 8.290   3rd Qu.: 0.8400   3rd Qu.:  3.235  
##  Max.   :1817.0   Max.   :11.730   Max.   :10.2000   Max.   :131.500  
##  NA&#39;s   :520      NA&#39;s   :520      NA&#39;s   :506       NA&#39;s   :506      
##  AquaFluor_CHL       Turbidity             TP               TDP         
##  Min.   :  12.76   Min.   :  0.680   Min.   :   0.00   Min.   :  0.160  
##  1st Qu.:  39.46   1st Qu.:  3.655   1st Qu.:  23.05   1st Qu.:  4.995  
##  Median :  71.34   Median : 10.040   Median :  40.11   Median :  7.960  
##  Mean   : 112.59   Mean   : 19.612   Mean   :  58.06   Mean   : 14.667  
##  3rd Qu.: 153.53   3rd Qu.: 21.925   3rd Qu.:  71.25   3rd Qu.: 16.695  
##  Max.   :1128.00   Max.   :829.000   Max.   :1467.61   Max.   :218.030  
##  NA&#39;s   :510       NA&#39;s   :506       NA&#39;s   :77        NA&#39;s   :119      
##       SRP               NH4              NO3              SiO2       
##  Min.   : 0.0000   Min.   :  0.00   Min.   :0.0000   Min.   : 0.000  
##  1st Qu.: 0.4675   1st Qu.:  3.00   1st Qu.:0.1100   1st Qu.: 1.350  
##  Median : 1.4000   Median :  6.54   Median :0.2900   Median : 1.865  
##  Mean   : 5.9827   Mean   : 17.60   Mean   :0.6008   Mean   : 3.200  
##  3rd Qu.: 7.5375   3rd Qu.: 17.88   3rd Qu.:0.5900   3rd Qu.: 2.630  
##  Max.   :94.9700   Max.   :548.44   Max.   :6.5500   Max.   :28.030  
##  NA&#39;s   :122       NA&#39;s   :123      NA&#39;s   :126      NA&#39;s   :396     
##        Cl             TSS              VSS               POC          
##  Min.   : 0.00   Min.   :  0.75   Min.   :  0.220   Min.   :  0.1400  
##  1st Qu.:14.84   1st Qu.:  4.51   1st Qu.:  1.600   1st Qu.:  0.5775  
##  Median :19.09   Median : 11.06   Median :  3.430   Median :  1.2800  
##  Mean   :20.65   Mean   : 16.90   Mean   :  7.645   Mean   :  2.7210  
##  3rd Qu.:25.41   3rd Qu.: 20.43   3rd Qu.:  7.625   3rd Qu.:  2.7200  
##  Max.   :51.42   Max.   :540.80   Max.   :515.000   Max.   :219.3400  
##  NA&#39;s   :396     NA&#39;s   :385      NA&#39;s   :403       NA&#39;s   :306       
##       PON               DOC              ExChla             ExPC          
##  Min.   : 0.0100   Min.   :  0.260   Min.   :  0.000   Min.   :    0.000  
##  1st Qu.: 0.1000   1st Qu.:  2.810   1st Qu.:  6.197   1st Qu.:    1.212  
##  Median : 0.2100   Median :  3.740   Median : 18.090   Median :    7.790  
##  Mean   : 0.4561   Mean   :  6.747   Mean   : 31.265   Mean   :   69.234  
##  3rd Qu.: 0.4600   3rd Qu.:  5.000   3rd Qu.: 39.150   3rd Qu.:   29.895  
##  Max.   :34.6800   Max.   :726.000   Max.   :466.500   Max.   :10855.300  
##  NA&#39;s   :306       NA&#39;s   :353       NA&#39;s   :46        NA&#39;s   :188        
##       pMC              dMC           pMC_LC_MS      TCyanos_cells      
##  Min.   : 0.000   Min.   :0.0000   Min.   : 0.000   Min.   :        0  
##  1st Qu.: 0.040   1st Qu.:0.1000   1st Qu.: 0.010   1st Qu.:      374  
##  Median : 0.260   Median :0.2700   Median : 0.130   Median :     7714  
##  Mean   : 1.834   Mean   :0.4219   Mean   : 0.833   Mean   :  1706517  
##  3rd Qu.: 1.400   3rd Qu.:0.5750   3rd Qu.: 0.900   3rd Qu.:    56152  
##  Max.   :56.350   Max.   :1.9400   Max.   :10.020   Max.   :123737288  
##                   NA&#39;s   :672      NA&#39;s   :625      NA&#39;s   :224        
##  TCyanos_volume   
##  Min.   :      0  
##  1st Qu.:     15  
##  Median :    274  
##  Mean   :  67098  
##  3rd Qu.:   1992  
##  Max.   :5777349  
##  NA&#39;s   :224</code></pre>
<p>There are a large number of missing values in the data. The variable of interest is the
microcystin concentration. We have two forms of MC: particular and dissolved<br />
(<code>pMC</code> and <code>dMC</code>, respectively). The variable <code>dMC</code> has 672 missing values, while <code>pMC</code>
does not have missing values. However, the method used for measuring MC has a `<code>detection  limit.''  Typically, when the measured concentrations are below the limit, we report them  as equal to the detection limit or 0 or half of the detection limit.  In this case,  we see the minimum</code>pMC` value is 0, suggesting that 0 is used for values below detection limit.
Based on personal communication, I learned that the detection limit for this data set is 0.1.<br />
In other words, the smallest non-zero concentration value should be 0.1.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(eriedata<span class="sc">$</span>pMC[eriedata<span class="sc">$</span>pMC<span class="sc">&gt;</span><span class="dv">0</span>]))[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>##  [1] 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.10</code></pre>
<p>However, the result from this line of code indicates otherwise, suggesting various practices
were used over time. After consulting with the person responsible for the monitoring project,
I replaced all values less than 0.1 with 0.1. This practice is definitely not ideal.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb58-1" aria-hidden="true" tabindex="-1"></a>eriedata<span class="sc">$</span>pMC[eriedata<span class="sc">$</span>pMC<span class="sc">&lt;</span><span class="fl">0.1</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb58-2"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.25</span>, <span class="fl">0.125</span>, <span class="dv">0</span>), <span class="at">las=</span><span class="dv">1</span>, <span class="at">tck=</span><span class="fl">0.01</span>)</span>
<span id="cb58-3"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pMC <span class="sc">~</span> POC, <span class="at">data=</span>eriedata)</span></code></pre></div>
<p><img src="RGraphics_Introduction_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pMC <span class="sc">~</span> POC, <span class="at">data=</span>eriedata, <span class="at">log=</span><span class="st">&quot;xy&quot;</span>)</span></code></pre></div>
<p><img src="RGraphics_Introduction_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pMC <span class="sc">~</span> POC, <span class="at">data=</span>eriedata, <span class="at">log=</span><span class="st">&quot;xy&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Particular Organic Carbon&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Microcystin&quot;</span>)</span></code></pre></div>
<p><img src="RGraphics_Introduction_files/figure-html/unnamed-chunk-7-3.png" width="672" /></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pMC <span class="sc">~</span> POC, <span class="at">data=</span>eriedata, <span class="at">log=</span><span class="st">&quot;xy&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Particular Organic Carbon&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Microcystin&quot;</span>, <span class="at">pch=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="RGraphics_Introduction_files/figure-html/unnamed-chunk-7-4.png" width="672" /></p>
</div>
<div id="mc-distribution" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> MC Distribution</h2>
<p>Knowledge the distribution of a variable is the basis of statistical inference. Statistical inference starts with a statistical distribution assumption on the variable of interest. Consequently, proposing a reasonable distribution assumption is the key to a successful statistical analysis. There are many theoretical distributions, most of them have complicated probability density functions.</p>
<p>In order to make a reasonable assumption, we need to know how to summarize the distribution of the data. We want to know a few simple facts before we can propose a reasonable distribution assumption. For example, what type of data do we have, categorical or numerical, if categorical, are the categories ordered; whether the variable is limited to be positive (or, more generally, bounded); whether the distribution of a numeric variable is symmetric; and whether the variation of the variable varies. Some of the features do not need statistical analysis; for example, stream flow cannot be negative. Some can be shown using simple graphics.</p>
<div id="histogram-and-boxplot" class="section level3" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Histogram and boxplot</h3>
<p>Go to page 68 of K &amp; V for histogram</p>
<p>Page 70 for box plot</p>
</div>
<div id="comparing-to-the-normal-distribution" class="section level3" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Comparing to the normal distribution</h3>
<p>The normal distribution is the most important distribution in statistics. We often need to evaluate whether the data can be approximated by the normal distribution before we can select an appropriate statistical method. Assessing normality is typically done using the normal quantile-quantile plot (Normal Q-Q plot).</p>
<p>A normal Q-Q plot is based on the relationship between the standard normal variable (<span class="math inline">\(z\sim N(0,1)\)</span>) and a normal distributed variable with mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span> (<span class="math inline">\(y\sim N(\mu, \sigma)\)</span>):
<span class="math display">\[
y_q = \mu + \sigma z_q
\]</span>
That is, the <span class="math inline">\(q\)</span> quantile of <span class="math inline">\(y\)</span> is a linear function of the <span class="math inline">\(q\)</span> quantile of <span class="math inline">\(z\)</span>. This relationship implies that if we can pair the quantiles of the data we want to evaluate to the quantiles of the standard normal distribution, we can evaluate whether the data is approximately normal by plotting the data quantiles against the standard normal quantiles. The the points on the plot form a straight line, the data have a normal distribution.</p>
<p>When we have a data set, we can calculate the approximate quantile of each data point. For example, in R, the <em>i</em>th ranked data point has a quantile of
<span class="math display">\[
q_i = \frac{i-0.5}{n}
\]</span>
For a data set with <span class="math inline">\(n=25\)</span>, the 5th ranked data point is the 18th percentile of the data. Or, <span class="math inline">\(y_{0.18} = y^{(5)}\)</span>. For a unit (standard) normal variable, the 18th percentile can be calculated usibg the function <code>qnorm</code>.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.18</span>)</span></code></pre></div>
<pre><code>## [1] -0.9153651</code></pre>
<p>The value -0.9153651 is paired with <span class="math inline">\(y^{(5)}\)</span>. We can do the same for all data points and plot them against their respective unit normal quantiles. The process of finding quantiles is programmed in the functions <code>qqnorm</code> and <code>qqline</code>:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb64-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb64-2"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(y)</span>
<span id="cb64-3"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(y)</span></code></pre></div>
<p><img src="RGraphics_Introduction_files/figure-html/unnamed-chunk-9-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="comparing-two-distributions" class="section level3" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Comparing Two Distributions</h3>
<p>We often are interested in comparing the bloom size/volume in different months.</p>
<ul>
<li>Overlying two histograms</li>
</ul>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Random numbers</span></span>
<span id="cb65-2"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb65-2" aria-hidden="true" tabindex="-1"></a>h2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">4</span>)</span>
<span id="cb65-3"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb65-3" aria-hidden="true" tabindex="-1"></a>h1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">6</span>)</span>
<span id="cb65-4"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram Grey Color</span></span>
<span id="cb65-6"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(h1, <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.5</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">200</span>), <span class="at">main=</span><span class="st">&quot;Overlapping Histogram&quot;</span>)</span>
<span id="cb65-7"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(h2, <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0.5</span>), <span class="at">add=</span>T)</span>
<span id="cb65-8"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code></pre></div>
<p><img src="RGraphics_Introduction_files/figure-html/unnamed-chunk-10-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram Colored (blue and red)</span></span>
<span id="cb66-2"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(h1, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">200</span>), <span class="at">main=</span><span class="st">&quot;Overlapping Histogram&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Variable&quot;</span>)</span>
<span id="cb66-3"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(h2, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>), <span class="at">add=</span>T)</span>
<span id="cb66-4"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code></pre></div>
<p><img src="RGraphics_Introduction_files/figure-html/unnamed-chunk-10-2.png" width="480" style="display: block; margin: auto;" /></p>
<ul>
<li>Side-by-side box plots</li>
</ul>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(h1, h2)</span></code></pre></div>
<p><img src="RGraphics_Introduction_files/figure-html/unnamed-chunk-11-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="do">## or:</span></span>
<span id="cb68-2"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb68-2" aria-hidden="true" tabindex="-1"></a>exdata<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y=</span><span class="fu">c</span>(h1, h2), <span class="at">grp=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">each=</span><span class="dv">1000</span>))</span>
<span id="cb68-3"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(y<span class="sc">~</span>grp, <span class="at">data=</span>exdata)</span></code></pre></div>
<p><img src="RGraphics_Introduction_files/figure-html/unnamed-chunk-11-2.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="do">## or:</span></span>
<span id="cb69-2"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(y<span class="sc">~</span>grp, <span class="at">data=</span>exdata, <span class="at">names=</span><span class="fu">c</span>(<span class="st">&quot;grp1&quot;</span>,<span class="st">&quot;grp2&quot;</span>))</span></code></pre></div>
<p><img src="RGraphics_Introduction_files/figure-html/unnamed-chunk-11-3.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="do">## now try:</span></span>
<span id="cb70-2"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb70-2" aria-hidden="true" tabindex="-1"></a>exdata<span class="sc">$</span>grp <span class="ot">&lt;-</span> <span class="fu">ordered</span>(exdata<span class="sc">$</span>grp, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;group 1&quot;</span>, <span class="st">&quot;group 2&quot;</span>))</span>
<span id="cb70-3"><a href="example-lake-erie-harmful-algal-bloom-monitoring.html#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(y<span class="sc">~</span>grp, <span class="at">data=</span>exdata)</span></code></pre></div>
<p><img src="RGraphics_Introduction_files/figure-html/unnamed-chunk-11-4.png" width="480" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="graphical-functions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
